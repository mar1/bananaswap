{"ast":null,"code":"import{createReducer}from'@reduxjs/toolkit';import{addTransaction,checkedTransaction,clearAllTransactions,finalizeTransaction}from'./actions';var now=function now(){return new Date().getTime();};export var initialState={};export default createReducer(initialState,function(builder){return builder.addCase(addTransaction,function(transactions,_ref){var _transactions$chainId,_transactions$chainId2;var _ref$payload=_ref.payload,chainId=_ref$payload.chainId,from=_ref$payload.from,hash=_ref$payload.hash,approval=_ref$payload.approval,summary=_ref$payload.summary;if((_transactions$chainId=transactions[chainId])===null||_transactions$chainId===void 0?void 0:_transactions$chainId[hash]){throw Error('Attempted to add existing transaction.');}var txs=(_transactions$chainId2=transactions[chainId])!==null&&_transactions$chainId2!==void 0?_transactions$chainId2:{};txs[hash]={hash:hash,approval:approval,summary:summary,from:from,addedTime:now()};transactions[chainId]=txs;}).addCase(clearAllTransactions,function(transactions,_ref2){var chainId=_ref2.payload.chainId;if(!transactions[chainId])return;transactions[chainId]={};}).addCase(checkedTransaction,function(transactions,_ref3){var _transactions$chainId3;var _ref3$payload=_ref3.payload,chainId=_ref3$payload.chainId,hash=_ref3$payload.hash,blockNumber=_ref3$payload.blockNumber;var tx=(_transactions$chainId3=transactions[chainId])===null||_transactions$chainId3===void 0?void 0:_transactions$chainId3[hash];if(!tx){return;}if(!tx.lastCheckedBlockNumber){tx.lastCheckedBlockNumber=blockNumber;}else{tx.lastCheckedBlockNumber=Math.max(blockNumber,tx.lastCheckedBlockNumber);}}).addCase(finalizeTransaction,function(transactions,_ref4){var _transactions$chainId4;var _ref4$payload=_ref4.payload,hash=_ref4$payload.hash,chainId=_ref4$payload.chainId,receipt=_ref4$payload.receipt;var tx=(_transactions$chainId4=transactions[chainId])===null||_transactions$chainId4===void 0?void 0:_transactions$chainId4[hash];if(!tx){return;}tx.receipt=receipt;tx.confirmedTime=now();});});","map":{"version":3,"sources":["C:/Users/marin/Desktop/bananaswap/src/state/transactions/reducer.ts"],"names":["createReducer","addTransaction","checkedTransaction","clearAllTransactions","finalizeTransaction","now","Date","getTime","initialState","builder","addCase","transactions","payload","chainId","from","hash","approval","summary","Error","txs","addedTime","blockNumber","tx","lastCheckedBlockNumber","Math","max","receipt","confirmedTime"],"mappings":"AAAA,OAASA,aAAT,KAA8B,kBAA9B,CACA,OACEC,cADF,CAEEC,kBAFF,CAGEC,oBAHF,CAIEC,mBAJF,KAMO,WANP,CAQA,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,SAAM,IAAIC,CAAAA,IAAJ,GAAWC,OAAX,EAAN,EAAZ,CAmBA,MAAO,IAAMC,CAAAA,YAA8B,CAAG,EAAvC,CAEP,cAAeR,CAAAA,aAAa,CAACQ,YAAD,CAAe,SAAAC,OAAO,QAChDA,CAAAA,OAAO,CACJC,OADH,CACWT,cADX,CAC2B,SAACU,YAAD,MAA2E,wEAA1DC,OAA0D,CAA/CC,OAA+C,cAA/CA,OAA+C,CAAtCC,IAAsC,cAAtCA,IAAsC,CAAhCC,IAAgC,cAAhCA,IAAgC,CAA1BC,QAA0B,cAA1BA,QAA0B,CAAhBC,OAAgB,cAAhBA,OAAgB,CAClG,0BAAIN,YAAY,CAACE,OAAD,CAAhB,gDAAI,sBAAwBE,IAAxB,CAAJ,CAAmC,CACjC,KAAMG,CAAAA,KAAK,CAAC,wCAAD,CAAX,CACD,CACD,GAAMC,CAAAA,GAAG,yBAAGR,YAAY,CAACE,OAAD,CAAf,iEAA4B,EAArC,CACAM,GAAG,CAACJ,IAAD,CAAH,CAAY,CAAEA,IAAI,CAAJA,IAAF,CAAQC,QAAQ,CAARA,QAAR,CAAkBC,OAAO,CAAPA,OAAlB,CAA2BH,IAAI,CAAJA,IAA3B,CAAiCM,SAAS,CAAEf,GAAG,EAA/C,CAAZ,CACAM,YAAY,CAACE,OAAD,CAAZ,CAAwBM,GAAxB,CACD,CARH,EASGT,OATH,CASWP,oBATX,CASiC,SAACQ,YAAD,OAA4C,IAAhBE,CAAAA,OAAgB,OAA3BD,OAA2B,CAAhBC,OAAgB,CACzE,GAAI,CAACF,YAAY,CAACE,OAAD,CAAjB,CAA4B,OAC5BF,YAAY,CAACE,OAAD,CAAZ,CAAwB,EAAxB,CACD,CAZH,EAaGH,OAbH,CAaWR,kBAbX,CAa+B,SAACS,YAAD,OAA+D,oDAA9CC,OAA8C,CAAnCC,OAAmC,eAAnCA,OAAmC,CAA1BE,IAA0B,eAA1BA,IAA0B,CAApBM,WAAoB,eAApBA,WAAoB,CAC1F,GAAMC,CAAAA,EAAE,yBAAGX,YAAY,CAACE,OAAD,CAAf,iDAAG,uBAAwBE,IAAxB,CAAX,CACA,GAAI,CAACO,EAAL,CAAS,CACP,OACD,CACD,GAAI,CAACA,EAAE,CAACC,sBAAR,CAAgC,CAC9BD,EAAE,CAACC,sBAAH,CAA4BF,WAA5B,CACD,CAFD,IAEO,CACLC,EAAE,CAACC,sBAAH,CAA4BC,IAAI,CAACC,GAAL,CAASJ,WAAT,CAAsBC,EAAE,CAACC,sBAAzB,CAA5B,CACD,CACF,CAvBH,EAwBGb,OAxBH,CAwBWN,mBAxBX,CAwBgC,SAACO,YAAD,OAA2D,oDAA1CC,OAA0C,CAA/BG,IAA+B,eAA/BA,IAA+B,CAAzBF,OAAyB,eAAzBA,OAAyB,CAAhBa,OAAgB,eAAhBA,OAAgB,CACvF,GAAMJ,CAAAA,EAAE,yBAAGX,YAAY,CAACE,OAAD,CAAf,iDAAG,uBAAwBE,IAAxB,CAAX,CACA,GAAI,CAACO,EAAL,CAAS,CACP,OACD,CACDA,EAAE,CAACI,OAAH,CAAaA,OAAb,CACAJ,EAAE,CAACK,aAAH,CAAmBtB,GAAG,EAAtB,CACD,CA/BH,CADgD,EAAtB,CAA5B","sourcesContent":["import { createReducer } from '@reduxjs/toolkit'\r\nimport {\r\n  addTransaction,\r\n  checkedTransaction,\r\n  clearAllTransactions,\r\n  finalizeTransaction,\r\n  SerializableTransactionReceipt\r\n} from './actions'\r\n\r\nconst now = () => new Date().getTime()\r\n\r\nexport interface TransactionDetails {\r\n  hash: string\r\n  approval?: { tokenAddress: string; spender: string }\r\n  summary?: string\r\n  receipt?: SerializableTransactionReceipt\r\n  lastCheckedBlockNumber?: number\r\n  addedTime: number\r\n  confirmedTime?: number\r\n  from: string\r\n}\r\n\r\nexport interface TransactionState {\r\n  [chainId: number]: {\r\n    [txHash: string]: TransactionDetails\r\n  }\r\n}\r\n\r\nexport const initialState: TransactionState = {}\r\n\r\nexport default createReducer(initialState, builder =>\r\n  builder\r\n    .addCase(addTransaction, (transactions, { payload: { chainId, from, hash, approval, summary } }) => {\r\n      if (transactions[chainId]?.[hash]) {\r\n        throw Error('Attempted to add existing transaction.')\r\n      }\r\n      const txs = transactions[chainId] ?? {}\r\n      txs[hash] = { hash, approval, summary, from, addedTime: now() }\r\n      transactions[chainId] = txs\r\n    })\r\n    .addCase(clearAllTransactions, (transactions, { payload: { chainId } }) => {\r\n      if (!transactions[chainId]) return\r\n      transactions[chainId] = {}\r\n    })\r\n    .addCase(checkedTransaction, (transactions, { payload: { chainId, hash, blockNumber } }) => {\r\n      const tx = transactions[chainId]?.[hash]\r\n      if (!tx) {\r\n        return\r\n      }\r\n      if (!tx.lastCheckedBlockNumber) {\r\n        tx.lastCheckedBlockNumber = blockNumber\r\n      } else {\r\n        tx.lastCheckedBlockNumber = Math.max(blockNumber, tx.lastCheckedBlockNumber)\r\n      }\r\n    })\r\n    .addCase(finalizeTransaction, (transactions, { payload: { hash, chainId, receipt } }) => {\r\n      const tx = transactions[chainId]?.[hash]\r\n      if (!tx) {\r\n        return\r\n      }\r\n      tx.receipt = receipt\r\n      tx.confirmedTime = now()\r\n    })\r\n)\r\n"]},"metadata":{},"sourceType":"module"}