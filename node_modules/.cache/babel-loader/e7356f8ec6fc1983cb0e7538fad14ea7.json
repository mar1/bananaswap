{"ast":null,"code":"import _slicedToArray from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _defineProperty from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import{CurrencyAmount,DEV,JSBI,Percent,Price}from'moonbeamswap';import{useCallback,useMemo}from'react';import{useDispatch,useSelector}from'react-redux';import{PairState,usePair}from'../../data/Reserves';import{useTotalSupply}from'../../data/TotalSupply';import{useTranslation}from'react-i18next';import{useActiveWeb3React}from'../../hooks';import{wrappedCurrency,wrappedCurrencyAmount}from'../../utils/wrappedCurrency';import{tryParseAmount}from'../swap/hooks';import{useCurrencyBalances}from'../wallet/hooks';import{Field,typeInput}from'./actions';var ZERO=JSBI.BigInt(0);export function useMintState(){return useSelector(function(state){return state.mint;});}export function useDerivedMintInfo(currencyA,currencyB){var _currencyBalances,_parsedAmounts,_currencyBalances$Fie,_currencyBalances$Fie2;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account,chainId=_useActiveWeb3React.chainId;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useMintState=useMintState(),independentField=_useMintState.independentField,typedValue=_useMintState.typedValue,otherTypedValue=_useMintState.otherTypedValue;var dependentField=independentField===Field.CURRENCY_A?Field.CURRENCY_B:Field.CURRENCY_A;// tokens\nvar currencies=useMemo(function(){var _ref;return _ref={},_defineProperty(_ref,Field.CURRENCY_A,currencyA!==null&&currencyA!==void 0?currencyA:undefined),_defineProperty(_ref,Field.CURRENCY_B,currencyB!==null&&currencyB!==void 0?currencyB:undefined),_ref;},[currencyA,currencyB]);// pair\nvar _usePair=usePair(currencies[Field.CURRENCY_A],currencies[Field.CURRENCY_B]),_usePair2=_slicedToArray(_usePair,2),pairState=_usePair2[0],pair=_usePair2[1];var totalSupply=useTotalSupply(pair===null||pair===void 0?void 0:pair.liquidityToken);var noLiquidity=pairState===PairState.NOT_EXISTS||Boolean(totalSupply&&JSBI.equal(totalSupply.raw,ZERO));// balances\nvar balances=useCurrencyBalances(account!==null&&account!==void 0?account:undefined,[currencies[Field.CURRENCY_A],currencies[Field.CURRENCY_B]]);var currencyBalances=(_currencyBalances={},_defineProperty(_currencyBalances,Field.CURRENCY_A,balances[0]),_defineProperty(_currencyBalances,Field.CURRENCY_B,balances[1]),_currencyBalances);// amounts\nvar independentAmount=tryParseAmount(typedValue,currencies[independentField]);var dependentAmount=useMemo(function(){if(noLiquidity){if(otherTypedValue&&currencies[dependentField]){return tryParseAmount(otherTypedValue,currencies[dependentField]);}return undefined;}else if(independentAmount){// we wrap the currencies just to get the price in terms of the other token\nvar wrappedIndependentAmount=wrappedCurrencyAmount(independentAmount,chainId);var _ref2=[wrappedCurrency(currencyA,chainId),wrappedCurrency(currencyB,chainId)],tokenA=_ref2[0],tokenB=_ref2[1];if(tokenA&&tokenB&&wrappedIndependentAmount&&pair){var dependentCurrency=dependentField===Field.CURRENCY_B?currencyB:currencyA;var dependentTokenAmount=dependentField===Field.CURRENCY_B?pair.priceOf(tokenA).quote(wrappedIndependentAmount):pair.priceOf(tokenB).quote(wrappedIndependentAmount);return dependentCurrency===DEV?CurrencyAmount.ether(dependentTokenAmount.raw):dependentTokenAmount;}return undefined;}else{return undefined;}},[noLiquidity,otherTypedValue,currencies,dependentField,independentAmount,currencyA,chainId,currencyB,pair]);var parsedAmounts=(_parsedAmounts={},_defineProperty(_parsedAmounts,Field.CURRENCY_A,independentField===Field.CURRENCY_A?independentAmount:dependentAmount),_defineProperty(_parsedAmounts,Field.CURRENCY_B,independentField===Field.CURRENCY_A?dependentAmount:independentAmount),_parsedAmounts);var price=useMemo(function(){if(noLiquidity){var _currencyAAmount=parsedAmounts[Field.CURRENCY_A],_currencyBAmount=parsedAmounts[Field.CURRENCY_B];if(_currencyAAmount&&_currencyBAmount){return new Price(_currencyAAmount.currency,_currencyBAmount.currency,_currencyAAmount.raw,_currencyBAmount.raw);}return undefined;}else{var wrappedCurrencyA=wrappedCurrency(currencyA,chainId);return pair&&wrappedCurrencyA?pair.priceOf(wrappedCurrencyA):undefined;}},[chainId,currencyA,noLiquidity,pair,parsedAmounts]);// liquidity minted\nvar liquidityMinted=useMemo(function(){var currencyAAmount=parsedAmounts[Field.CURRENCY_A],currencyBAmount=parsedAmounts[Field.CURRENCY_B];var _ref3=[wrappedCurrencyAmount(currencyAAmount,chainId),wrappedCurrencyAmount(currencyBAmount,chainId)],tokenAmountA=_ref3[0],tokenAmountB=_ref3[1];if(pair&&totalSupply&&tokenAmountA&&tokenAmountB){return pair.getLiquidityMinted(totalSupply,tokenAmountA,tokenAmountB);}else{return undefined;}},[parsedAmounts,chainId,pair,totalSupply]);var poolTokenPercentage=useMemo(function(){if(liquidityMinted&&totalSupply){return new Percent(liquidityMinted.raw,totalSupply.add(liquidityMinted).raw);}else{return undefined;}},[liquidityMinted,totalSupply]);var error;if(!account){error=t('connectWallet');}if(pairState===PairState.INVALID){var _error;error=(_error=error)!==null&&_error!==void 0?_error:t('invalidPair');}if(!parsedAmounts[Field.CURRENCY_A]||!parsedAmounts[Field.CURRENCY_B]){var _error2;error=(_error2=error)!==null&&_error2!==void 0?_error2:t('enterAnAmount');}var currencyAAmount=parsedAmounts[Field.CURRENCY_A],currencyBAmount=parsedAmounts[Field.CURRENCY_B];if(currencyAAmount&&(currencyBalances===null||currencyBalances===void 0?void 0:(_currencyBalances$Fie=currencyBalances[Field.CURRENCY_A])===null||_currencyBalances$Fie===void 0?void 0:_currencyBalances$Fie.lessThan(currencyAAmount))){var _currencies$Field$CUR;error='Insufficient '+((_currencies$Field$CUR=currencies[Field.CURRENCY_A])===null||_currencies$Field$CUR===void 0?void 0:_currencies$Field$CUR.symbol)+' balance';}if(currencyBAmount&&(currencyBalances===null||currencyBalances===void 0?void 0:(_currencyBalances$Fie2=currencyBalances[Field.CURRENCY_B])===null||_currencyBalances$Fie2===void 0?void 0:_currencyBalances$Fie2.lessThan(currencyBAmount))){var _currencies$Field$CUR2;error='Insufficient '+((_currencies$Field$CUR2=currencies[Field.CURRENCY_B])===null||_currencies$Field$CUR2===void 0?void 0:_currencies$Field$CUR2.symbol)+' balance';}return{dependentField:dependentField,currencies:currencies,pair:pair,pairState:pairState,currencyBalances:currencyBalances,parsedAmounts:parsedAmounts,price:price,noLiquidity:noLiquidity,liquidityMinted:liquidityMinted,poolTokenPercentage:poolTokenPercentage,error:error};}export function useMintActionHandlers(noLiquidity){var dispatch=useDispatch();var onFieldAInput=useCallback(function(typedValue){dispatch(typeInput({field:Field.CURRENCY_A,typedValue:typedValue,noLiquidity:noLiquidity===true}));},[dispatch,noLiquidity]);var onFieldBInput=useCallback(function(typedValue){dispatch(typeInput({field:Field.CURRENCY_B,typedValue:typedValue,noLiquidity:noLiquidity===true}));},[dispatch,noLiquidity]);return{onFieldAInput:onFieldAInput,onFieldBInput:onFieldBInput};}","map":{"version":3,"sources":["C:/Users/marin/Desktop/bananaswap/src/state/mint/hooks.ts"],"names":["CurrencyAmount","DEV","JSBI","Percent","Price","useCallback","useMemo","useDispatch","useSelector","PairState","usePair","useTotalSupply","useTranslation","useActiveWeb3React","wrappedCurrency","wrappedCurrencyAmount","tryParseAmount","useCurrencyBalances","Field","typeInput","ZERO","BigInt","useMintState","state","mint","useDerivedMintInfo","currencyA","currencyB","account","chainId","t","independentField","typedValue","otherTypedValue","dependentField","CURRENCY_A","CURRENCY_B","currencies","undefined","pairState","pair","totalSupply","liquidityToken","noLiquidity","NOT_EXISTS","Boolean","equal","raw","balances","currencyBalances","independentAmount","dependentAmount","wrappedIndependentAmount","tokenA","tokenB","dependentCurrency","dependentTokenAmount","priceOf","quote","ether","parsedAmounts","price","currencyAAmount","currencyBAmount","currency","wrappedCurrencyA","liquidityMinted","tokenAmountA","tokenAmountB","getLiquidityMinted","poolTokenPercentage","add","error","INVALID","lessThan","symbol","useMintActionHandlers","dispatch","onFieldAInput","field","onFieldBInput"],"mappings":"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","sourcesContent":["import { Currency, CurrencyAmount, DEV, JSBI, Pair, Percent, Price, TokenAmount } from 'moonbeamswap'\r\nimport { useCallback, useMemo } from 'react'\r\nimport { useDispatch, useSelector } from 'react-redux'\r\nimport { PairState, usePair } from '../../data/Reserves'\r\nimport { useTotalSupply } from '../../data/TotalSupply'\r\nimport { useTranslation } from 'react-i18next'\r\n\r\nimport { useActiveWeb3React } from '../../hooks'\r\nimport { wrappedCurrency, wrappedCurrencyAmount } from '../../utils/wrappedCurrency'\r\nimport { AppDispatch, AppState } from '../index'\r\nimport { tryParseAmount } from '../swap/hooks'\r\nimport { useCurrencyBalances } from '../wallet/hooks'\r\nimport { Field, typeInput } from './actions'\r\n\r\nconst ZERO = JSBI.BigInt(0)\r\n\r\nexport function useMintState(): AppState['mint'] {\r\n  return useSelector<AppState, AppState['mint']>(state => state.mint)\r\n}\r\n\r\nexport function useDerivedMintInfo(\r\n  currencyA: Currency | undefined,\r\n  currencyB: Currency | undefined\r\n): {\r\n  dependentField: Field\r\n  currencies: { [field in Field]?: Currency }\r\n  pair?: Pair | null\r\n  pairState: PairState\r\n  currencyBalances: { [field in Field]?: CurrencyAmount }\r\n  parsedAmounts: { [field in Field]?: CurrencyAmount }\r\n  price?: Price\r\n  noLiquidity?: boolean\r\n  liquidityMinted?: TokenAmount\r\n  poolTokenPercentage?: Percent\r\n  error?: string\r\n} {\r\n  const { account, chainId } = useActiveWeb3React()\r\n\r\n  const { t } = useTranslation()\r\n\r\n  const { independentField, typedValue, otherTypedValue } = useMintState()\r\n\r\n  const dependentField = independentField === Field.CURRENCY_A ? Field.CURRENCY_B : Field.CURRENCY_A\r\n\r\n  // tokens\r\n  const currencies: { [field in Field]?: Currency } = useMemo(\r\n    () => ({\r\n      [Field.CURRENCY_A]: currencyA ?? undefined,\r\n      [Field.CURRENCY_B]: currencyB ?? undefined\r\n    }),\r\n    [currencyA, currencyB]\r\n  )\r\n\r\n  // pair\r\n  const [pairState, pair] = usePair(currencies[Field.CURRENCY_A], currencies[Field.CURRENCY_B])\r\n  const totalSupply = useTotalSupply(pair?.liquidityToken)\r\n\r\n  const noLiquidity: boolean =\r\n    pairState === PairState.NOT_EXISTS || Boolean(totalSupply && JSBI.equal(totalSupply.raw, ZERO))\r\n\r\n  // balances\r\n  const balances = useCurrencyBalances(account ?? undefined, [\r\n    currencies[Field.CURRENCY_A],\r\n    currencies[Field.CURRENCY_B]\r\n  ])\r\n  const currencyBalances: { [field in Field]?: CurrencyAmount } = {\r\n    [Field.CURRENCY_A]: balances[0],\r\n    [Field.CURRENCY_B]: balances[1]\r\n  }\r\n\r\n  // amounts\r\n  const independentAmount: CurrencyAmount | undefined = tryParseAmount(typedValue, currencies[independentField])\r\n  const dependentAmount: CurrencyAmount | undefined = useMemo(() => {\r\n    if (noLiquidity) {\r\n      if (otherTypedValue && currencies[dependentField]) {\r\n        return tryParseAmount(otherTypedValue, currencies[dependentField])\r\n      }\r\n      return undefined\r\n    } else if (independentAmount) {\r\n      // we wrap the currencies just to get the price in terms of the other token\r\n      const wrappedIndependentAmount = wrappedCurrencyAmount(independentAmount, chainId)\r\n      const [tokenA, tokenB] = [wrappedCurrency(currencyA, chainId), wrappedCurrency(currencyB, chainId)]\r\n      if (tokenA && tokenB && wrappedIndependentAmount && pair) {\r\n        const dependentCurrency = dependentField === Field.CURRENCY_B ? currencyB : currencyA\r\n        const dependentTokenAmount =\r\n          dependentField === Field.CURRENCY_B\r\n            ? pair.priceOf(tokenA).quote(wrappedIndependentAmount)\r\n            : pair.priceOf(tokenB).quote(wrappedIndependentAmount)\r\n        return dependentCurrency === DEV ? CurrencyAmount.ether(dependentTokenAmount.raw) : dependentTokenAmount\r\n      }\r\n      return undefined\r\n    } else {\r\n      return undefined\r\n    }\r\n  }, [noLiquidity, otherTypedValue, currencies, dependentField, independentAmount, currencyA, chainId, currencyB, pair])\r\n  const parsedAmounts: { [field in Field]: CurrencyAmount | undefined } = {\r\n    [Field.CURRENCY_A]: independentField === Field.CURRENCY_A ? independentAmount : dependentAmount,\r\n    [Field.CURRENCY_B]: independentField === Field.CURRENCY_A ? dependentAmount : independentAmount\r\n  }\r\n\r\n  const price = useMemo(() => {\r\n    if (noLiquidity) {\r\n      const { [Field.CURRENCY_A]: currencyAAmount, [Field.CURRENCY_B]: currencyBAmount } = parsedAmounts\r\n      if (currencyAAmount && currencyBAmount) {\r\n        return new Price(currencyAAmount.currency, currencyBAmount.currency, currencyAAmount.raw, currencyBAmount.raw)\r\n      }\r\n      return undefined\r\n    } else {\r\n      const wrappedCurrencyA = wrappedCurrency(currencyA, chainId)\r\n      return pair && wrappedCurrencyA ? pair.priceOf(wrappedCurrencyA) : undefined\r\n    }\r\n  }, [chainId, currencyA, noLiquidity, pair, parsedAmounts])\r\n\r\n  // liquidity minted\r\n  const liquidityMinted = useMemo(() => {\r\n    const { [Field.CURRENCY_A]: currencyAAmount, [Field.CURRENCY_B]: currencyBAmount } = parsedAmounts\r\n    const [tokenAmountA, tokenAmountB] = [\r\n      wrappedCurrencyAmount(currencyAAmount, chainId),\r\n      wrappedCurrencyAmount(currencyBAmount, chainId)\r\n    ]\r\n    if (pair && totalSupply && tokenAmountA && tokenAmountB) {\r\n      return pair.getLiquidityMinted(totalSupply, tokenAmountA, tokenAmountB)\r\n    } else {\r\n      return undefined\r\n    }\r\n  }, [parsedAmounts, chainId, pair, totalSupply])\r\n\r\n  const poolTokenPercentage = useMemo(() => {\r\n    if (liquidityMinted && totalSupply) {\r\n      return new Percent(liquidityMinted.raw, totalSupply.add(liquidityMinted).raw)\r\n    } else {\r\n      return undefined\r\n    }\r\n  }, [liquidityMinted, totalSupply])\r\n\r\n  let error: string | undefined\r\n  if (!account) {\r\n    error = t('connectWallet')\r\n  }\r\n\r\n  if (pairState === PairState.INVALID) {\r\n    error = error ?? t('invalidPair')\r\n  }\r\n\r\n  if (!parsedAmounts[Field.CURRENCY_A] || !parsedAmounts[Field.CURRENCY_B]) {\r\n    error = error ?? t('enterAnAmount')\r\n  }\r\n\r\n  const { [Field.CURRENCY_A]: currencyAAmount, [Field.CURRENCY_B]: currencyBAmount } = parsedAmounts\r\n\r\n  if (currencyAAmount && currencyBalances?.[Field.CURRENCY_A]?.lessThan(currencyAAmount)) {\r\n    error = 'Insufficient ' + currencies[Field.CURRENCY_A]?.symbol + ' balance'\r\n  }\r\n\r\n  if (currencyBAmount && currencyBalances?.[Field.CURRENCY_B]?.lessThan(currencyBAmount)) {\r\n    error = 'Insufficient ' + currencies[Field.CURRENCY_B]?.symbol + ' balance'\r\n  }\r\n\r\n  return {\r\n    dependentField,\r\n    currencies,\r\n    pair,\r\n    pairState,\r\n    currencyBalances,\r\n    parsedAmounts,\r\n    price,\r\n    noLiquidity,\r\n    liquidityMinted,\r\n    poolTokenPercentage,\r\n    error\r\n  }\r\n}\r\n\r\nexport function useMintActionHandlers(\r\n  noLiquidity: boolean | undefined\r\n): {\r\n  onFieldAInput: (typedValue: string) => void\r\n  onFieldBInput: (typedValue: string) => void\r\n} {\r\n  const dispatch = useDispatch<AppDispatch>()\r\n\r\n  const onFieldAInput = useCallback(\r\n    (typedValue: string) => {\r\n      dispatch(typeInput({ field: Field.CURRENCY_A, typedValue, noLiquidity: noLiquidity === true }))\r\n    },\r\n    [dispatch, noLiquidity]\r\n  )\r\n  const onFieldBInput = useCallback(\r\n    (typedValue: string) => {\r\n      dispatch(typeInput({ field: Field.CURRENCY_B, typedValue, noLiquidity: noLiquidity === true }))\r\n    },\r\n    [dispatch, noLiquidity]\r\n  )\r\n\r\n  return {\r\n    onFieldAInput,\r\n    onFieldBInput\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}