{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\src\\\\pages\\\\Earn\\\\index.tsx\";\nimport { JSBI, Token, ChainId } from 'moonbeamswap';\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { Text } from 'rebass';\nimport { useTranslation } from 'react-i18next';\nimport { ButtonPrimary } from '../../components/Button';\nimport { AutoColumn } from '../../components/Column';\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel';\nimport { StakeTabs } from '../../components/NavigationTabs';\nimport { useTokenBalancesWithLoadingIndicator } from '../../state/wallet/hooks';\nimport { useActiveWeb3React } from '../../hooks';\nimport { ApprovalState, useApproveCallbackFromTrade } from '../../hooks/useApproveCallback';\nimport useToggledVersion, { Version } from '../../hooks/useToggledVersion';\nimport useWrapCallback, { WrapType } from '../../hooks/useWrapCallback';\nimport { Field } from '../../state/swap/actions';\nimport { useDerivedSwapInfo, useSwapActionHandlers, useSwapState } from '../../state/swap/hooks';\nimport { useUserSlippageTolerance } from '../../state/user/hooks';\nimport { maxAmountSpend } from '../../utils/maxAmountSpend';\nimport AppBody from '../AppBody';\nimport { toV2LiquidityToken, useTrackedTokenPairs } from '../../state/user/hooks';\nimport '.././style.css';\nimport { ethers } from 'ethers';\nimport Stake from './components/Stake';\nimport { lpTokenAddress, farmAddress, lpTokenABI, farmABI } from './conf.js';\nexport default function Swap() {\n  var _parsedAmounts$indepe, _parsedAmounts$indepe2, _parsedAmounts$depend, _parsedAmounts$depend2, _parsedAmounts$indepe3, _parsedAmounts$Field$;\n\n  const {\n    t\n  } = useTranslation();\n  const {\n    account\n  } = useActiveWeb3React();\n  const LP = new Token(ChainId.MOONBASE, '0x205A1AecA18DDCB130825B961BcE897302690A5d', 18, 'BAN', 'Bananaswap'); // swap state\n\n  const {\n    independentField,\n    typedValue,\n    recipient\n  } = useSwapState();\n  const {\n    v2Trade,\n    currencyBalances,\n    parsedAmount,\n    currencies,\n    inputError: swapInputError\n  } = useDerivedSwapInfo();\n  const {\n    wrapType,\n    execute: onWrap,\n    inputError: wrapInputError\n  } = useWrapCallback(currencies[Field.INPUT], currencies[Field.OUTPUT], typedValue);\n  console.log(onWrap);\n  console.log(currencies, wrapInputError);\n  const showWrap = wrapType !== WrapType.NOT_APPLICABLE;\n  const toggledVersion = useToggledVersion();\n  const trade = showWrap ? undefined : {\n    [Version.v2]: v2Trade\n  }[toggledVersion];\n  const parsedAmounts = showWrap ? {\n    [Field.INPUT]: parsedAmount,\n    [Field.OUTPUT]: parsedAmount\n  } : {\n    [Field.INPUT]: independentField === Field.INPUT ? parsedAmount : trade === null || trade === void 0 ? void 0 : trade.inputAmount,\n    [Field.OUTPUT]: independentField === Field.OUTPUT ? parsedAmount : trade === null || trade === void 0 ? void 0 : trade.outputAmount\n  };\n  const {\n    onSwitchTokens,\n    onCurrencySelection,\n    onUserInput,\n    onChangeRecipient\n  } = useSwapActionHandlers();\n  const isValid = !swapInputError;\n  const dependentField = independentField === Field.INPUT ? Field.OUTPUT : Field.INPUT;\n  console.log(onSwitchTokens, isValid, onChangeRecipient);\n  const trackedTokenPairs = useTrackedTokenPairs();\n  const tokenPairsWithLiquidityTokens = useMemo(() => trackedTokenPairs.map(tokens => ({\n    liquidityToken: toV2LiquidityToken(tokens),\n    tokens\n  })), [trackedTokenPairs]);\n  const liquidityTokens = useMemo(() => tokenPairsWithLiquidityTokens.map(tpwlt => tpwlt.liquidityToken), [tokenPairsWithLiquidityTokens]);\n  const [v2PairsBalances, fetchingV2PairBalances] = useTokenBalancesWithLoadingIndicator(account !== null && account !== void 0 ? account : undefined, liquidityTokens);\n  console.log(fetchingV2PairBalances); // fetch the reserves for all V2 pools in which the user has a balance\n\n  const liquidityTokensWithBalances = useMemo(() => tokenPairsWithLiquidityTokens.filter(({\n    liquidityToken\n  }) => {\n    var _v2PairsBalances$liqu;\n\n    return (_v2PairsBalances$liqu = v2PairsBalances[liquidityToken.address]) === null || _v2PairsBalances$liqu === void 0 ? void 0 : _v2PairsBalances$liqu.greaterThan('0');\n  }), [tokenPairsWithLiquidityTokens, v2PairsBalances]);\n  console.log(liquidityTokensWithBalances);\n  const formattedAmounts = {\n    [independentField]: typedValue,\n    [dependentField]: showWrap ? (_parsedAmounts$indepe = (_parsedAmounts$indepe2 = parsedAmounts[independentField]) === null || _parsedAmounts$indepe2 === void 0 ? void 0 : _parsedAmounts$indepe2.toExact()) !== null && _parsedAmounts$indepe !== void 0 ? _parsedAmounts$indepe : '' : (_parsedAmounts$depend = (_parsedAmounts$depend2 = parsedAmounts[dependentField]) === null || _parsedAmounts$depend2 === void 0 ? void 0 : _parsedAmounts$depend2.toSignificant(6)) !== null && _parsedAmounts$depend !== void 0 ? _parsedAmounts$depend : ''\n  };\n  const route = trade === null || trade === void 0 ? void 0 : trade.route;\n  const userHasSpecifiedInputOutput = Boolean(currencies[Field.INPUT] && ((_parsedAmounts$indepe3 = parsedAmounts[independentField]) === null || _parsedAmounts$indepe3 === void 0 ? void 0 : _parsedAmounts$indepe3.greaterThan(JSBI.BigInt(0))));\n  const noRoute = !route;\n  const [allowedSlippage] = useUserSlippageTolerance(); // check whether the user has approved the router on the input token\n\n  const [approval, approveCallback] = useApproveCallbackFromTrade(trade, allowedSlippage);\n  console.log(userHasSpecifiedInputOutput, noRoute, approveCallback); // check if user has gone through approval process, used to show two step buttons, reset on token change\n\n  const [approvalSubmitted, setApprovalSubmitted] = useState(false); // mark when a user has submitted an approval, reset onTokenSelection for input field\n\n  useEffect(() => {\n    if (approval === ApprovalState.PENDING) {\n      setApprovalSubmitted(true);\n    }\n  }, [approval, approvalSubmitted]);\n  const handleInputSelect = useCallback(inputCurrency => {\n    setApprovalSubmitted(false); // reset 2 step UI for approvals\n\n    onCurrencySelection(Field.INPUT, inputCurrency);\n  }, [onCurrencySelection]);\n  const handleTypeInput = useCallback(value => {\n    onUserInput(Field.INPUT, value);\n  }, [onUserInput]);\n  const handleTypeOutput = useCallback(value => {\n    onUserInput(Field.OUTPUT, value);\n  }, [onUserInput]);\n  const maxAmountInput = maxAmountSpend(currencyBalances[Field.INPUT]);\n  const atMaxAmountInput = Boolean(maxAmountInput && ((_parsedAmounts$Field$ = parsedAmounts[Field.INPUT]) === null || _parsedAmounts$Field$ === void 0 ? void 0 : _parsedAmounts$Field$.equalTo(maxAmountInput)));\n  const handleMaxInput = useCallback(() => {\n    alert('o');\n  }, [maxAmountInput, onUserInput]);\n  console.log(Field.INPUT, handleTypeOutput, atMaxAmountInput, handleMaxInput, maxAmountInput, onUserInput, recipient);\n\n  async function replace() {\n    let imgLp = await window.document.querySelector('#swap-currency-input2 > div > div.sc-cqCuEk.bFUFXO > button > span');\n\n    if (imgLp) {\n      imgLp.innerHTML = `<img src=\"http://localhost:3000/bananascoin.png\" width='34px;'></img><span style=\"padding-left: 0.3rem;\">BAN</span>`;\n    }\n\n    const provider = new ethers.providers.Web3Provider(window.ethereum);\n    await provider.send(\"eth_requestAccounts\", []);\n    const signer = provider.getSigner();\n    const signerAddress = await signer.getAddress();\n    console.log(signerAddress);\n    const farmContract = new ethers.Contract(farmAddress, farmABI, provider);\n    let rewardsPerBlock = await farmContract.rewardPerBlock();\n    rewardsPerBlock = ethers.utils.formatUnits(rewardsPerBlock, 18);\n    let APR = rewardsPerBlock * 1855058;\n    let APRp = window.document.getElementById('apr');\n    APRp.innerText = `APY: ${Number(APR).toFixed(2)} %`;\n  }\n\n  replace();\n\n  async function StakeLP() {\n    const provider2 = new ethers.providers.Web3Provider(window.ethereum);\n    await provider2.send(\"eth_requestAccounts\", []);\n    const signer2 = provider2.getSigner();\n    console.log(signer2);\n    let tokenAmount = await window.document.getElementsByClassName('token-amount-input');\n    const amountToDeposit = tokenAmount[0].value;\n    const numberOfDecimals = 18;\n    var spNb = ethers.utils.parseUnits(amountToDeposit, numberOfDecimals);\n    const farmContract = new ethers.Contract(farmAddress, farmABI, signer2);\n    const LPContract = new ethers.Contract(lpTokenAddress, lpTokenABI, signer2);\n    const Approve = await LPContract.approve(farmAddress, spNb);\n    const tx = await Approve.wait();\n    const event = tx.events[0];\n    const enterStaking = await farmContract.deposit(\"0\", spNb);\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(AppBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(StakeTabs, {\n    active: 'earn',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 1\n    }\n  }), /*#__PURE__*/React.createElement(AutoColumn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 1\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: \"https://bananaswap.vercel.app/bananascoin.png\",\n    width: \"150px\",\n    id: \"coinlogo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 3\n    }\n  }), /*#__PURE__*/React.createElement(Text, {\n    textAlign: \"center\",\n    id: \"text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 1\n    }\n  }, \"Stake your LP tokens to get extra $BANANAS rewards\"), /*#__PURE__*/React.createElement(CurrencyInputPanel, {\n    label: independentField === Field.OUTPUT && !showWrap && trade ? 'From (estimated)' : 'From',\n    value: formattedAmounts[Field.INPUT],\n    currency: LP,\n    onUserInput: handleTypeInput,\n    onCurrencySelect: handleInputSelect,\n    disableCurrencySelect: true,\n    showMaxButton: false,\n    showCommonBases: true,\n    id: \"swap-currency-input2\"\n    /*\r\n    otherCurrency={currencies[Field.OUTPUT]}\r\n    */\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 1\n    }\n  }), /*#__PURE__*/React.createElement(ButtonPrimary, {\n    id: \"join-pool-button\",\n    onClick: StakeLP,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    fontWeight: 500,\n    fontSize: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }\n  }, t('stakeLp'))), /*#__PURE__*/React.createElement(Text, {\n    textAlign: 'center',\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 5\n    }\n  }, \"2 transactions to complete\"), /*#__PURE__*/React.createElement(Text, {\n    fontWeight: 500,\n    fontSize: 20,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Text, {\n    id: \"apr\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 5\n    }\n  })), /*#__PURE__*/React.createElement(Stake, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 5\n    }\n  }))));\n} //465: {betterTradeLinkVersion && <BetterTradeLink version={betterTradeLinkVersion} />}","map":{"version":3,"sources":["C:/Users/marin/Desktop/bananaswap/src/pages/Earn/index.tsx"],"names":["JSBI","Token","ChainId","React","useCallback","useEffect","useMemo","useState","Text","useTranslation","ButtonPrimary","AutoColumn","CurrencyInputPanel","StakeTabs","useTokenBalancesWithLoadingIndicator","useActiveWeb3React","ApprovalState","useApproveCallbackFromTrade","useToggledVersion","Version","useWrapCallback","WrapType","Field","useDerivedSwapInfo","useSwapActionHandlers","useSwapState","useUserSlippageTolerance","maxAmountSpend","AppBody","toV2LiquidityToken","useTrackedTokenPairs","ethers","Stake","lpTokenAddress","farmAddress","lpTokenABI","farmABI","Swap","t","account","LP","MOONBASE","independentField","typedValue","recipient","v2Trade","currencyBalances","parsedAmount","currencies","inputError","swapInputError","wrapType","execute","onWrap","wrapInputError","INPUT","OUTPUT","console","log","showWrap","NOT_APPLICABLE","toggledVersion","trade","undefined","v2","parsedAmounts","inputAmount","outputAmount","onSwitchTokens","onCurrencySelection","onUserInput","onChangeRecipient","isValid","dependentField","trackedTokenPairs","tokenPairsWithLiquidityTokens","map","tokens","liquidityToken","liquidityTokens","tpwlt","v2PairsBalances","fetchingV2PairBalances","liquidityTokensWithBalances","filter","address","greaterThan","formattedAmounts","toExact","toSignificant","route","userHasSpecifiedInputOutput","Boolean","BigInt","noRoute","allowedSlippage","approval","approveCallback","approvalSubmitted","setApprovalSubmitted","PENDING","handleInputSelect","inputCurrency","handleTypeInput","value","handleTypeOutput","maxAmountInput","atMaxAmountInput","equalTo","handleMaxInput","alert","replace","imgLp","window","document","querySelector","innerHTML","provider","providers","Web3Provider","ethereum","send","signer","getSigner","signerAddress","getAddress","farmContract","Contract","rewardsPerBlock","rewardPerBlock","utils","formatUnits","APR","APRp","getElementById","innerText","Number","toFixed","StakeLP","provider2","signer2","tokenAmount","getElementsByClassName","amountToDeposit","numberOfDecimals","spNb","parseUnits","LPContract","Approve","approve","tx","wait","event","events","enterStaking","deposit"],"mappings":"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","sourcesContent":["import { CurrencyAmount, JSBI, Token, ChainId } from 'moonbeamswap'\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport { Text } from 'rebass'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { Link } from 'react-router-dom'\r\nimport { ButtonPrimary } from '../../components/Button'\r\nimport { AutoColumn } from '../../components/Column'\r\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel'\r\nimport { StakeTabs } from '../../components/NavigationTabs'\r\nimport { useTokenBalancesWithLoadingIndicator } from '../../state/wallet/hooks'\r\nimport { useActiveWeb3React } from '../../hooks'\r\nimport { ApprovalState, useApproveCallbackFromTrade } from '../../hooks/useApproveCallback'\r\nimport useToggledVersion, { Version } from '../../hooks/useToggledVersion'\r\nimport useWrapCallback, { WrapType } from '../../hooks/useWrapCallback'\r\nimport { Field } from '../../state/swap/actions'\r\nimport {\r\n  useDerivedSwapInfo,\r\n  useSwapActionHandlers,\r\n  useSwapState\r\n} from '../../state/swap/hooks'\r\nimport { useUserSlippageTolerance } from '../../state/user/hooks'\r\nimport { maxAmountSpend } from '../../utils/maxAmountSpend'\r\nimport AppBody from '../AppBody'\r\nimport { toV2LiquidityToken, useTrackedTokenPairs } from '../../state/user/hooks'\r\nimport '.././style.css'\r\nimport { ethers } from 'ethers'\r\n\r\nimport Stake from './components/Stake'\r\nimport { lpTokenAddress, farmAddress, lpTokenABI, farmABI} from './conf.js'\r\n\r\ndeclare let window: any;\r\n\r\nexport default function Swap() {\r\n  const { t } = useTranslation()\r\n  const { account } = useActiveWeb3React()\r\n\r\n const LP = new Token(ChainId.MOONBASE, '0x205A1AecA18DDCB130825B961BcE897302690A5d', 18, 'BAN', 'Bananaswap')\r\n\r\n    // swap state\r\n    const { independentField, typedValue, recipient } = useSwapState()\r\n    const { v2Trade, currencyBalances, parsedAmount, currencies, inputError: swapInputError } = useDerivedSwapInfo()\r\n    const { wrapType, execute: onWrap, inputError: wrapInputError } = useWrapCallback(\r\n      currencies[Field.INPUT],\r\n      currencies[Field.OUTPUT],\r\n      typedValue\r\n    )\r\n    console.log(onWrap)\r\n    console.log(currencies, wrapInputError)\r\n    const showWrap: boolean = wrapType !== WrapType.NOT_APPLICABLE\r\n    const toggledVersion = useToggledVersion()\r\n    const trade = showWrap\r\n      ? undefined\r\n      : {\r\n          [Version.v2]: v2Trade\r\n        }[toggledVersion]\r\n  \r\n    const parsedAmounts = showWrap\r\n      ? {\r\n          [Field.INPUT]: parsedAmount,\r\n          [Field.OUTPUT]: parsedAmount\r\n        }\r\n      : {\r\n          [Field.INPUT]: independentField === Field.INPUT ? parsedAmount : trade?.inputAmount,\r\n          [Field.OUTPUT]: independentField === Field.OUTPUT ? parsedAmount : trade?.outputAmount\r\n        }\r\n  \r\n    const { onSwitchTokens, onCurrencySelection, onUserInput, onChangeRecipient } = useSwapActionHandlers()\r\n    const isValid = !swapInputError\r\n    const dependentField: Field = independentField === Field.INPUT ? Field.OUTPUT : Field.INPUT\r\n    console.log(onSwitchTokens,isValid,onChangeRecipient)\r\n\r\n  const trackedTokenPairs = useTrackedTokenPairs()\r\n  const tokenPairsWithLiquidityTokens = useMemo(\r\n    () => trackedTokenPairs.map(tokens => ({ liquidityToken: toV2LiquidityToken(tokens), tokens })),\r\n    [trackedTokenPairs]\r\n  )\r\n  const liquidityTokens = useMemo(() => tokenPairsWithLiquidityTokens.map(tpwlt => tpwlt.liquidityToken), [\r\n    tokenPairsWithLiquidityTokens\r\n  ])\r\n  const [v2PairsBalances, fetchingV2PairBalances] = useTokenBalancesWithLoadingIndicator(\r\n    account ?? undefined,\r\n    liquidityTokens\r\n  )\r\n  console.log(fetchingV2PairBalances)\r\n  // fetch the reserves for all V2 pools in which the user has a balance\r\n  const liquidityTokensWithBalances = useMemo(\r\n    () =>\r\n      tokenPairsWithLiquidityTokens.filter(({ liquidityToken }) =>\r\n        v2PairsBalances[liquidityToken.address]?.greaterThan('0')\r\n      ),\r\n    [tokenPairsWithLiquidityTokens, v2PairsBalances]\r\n  )\r\nconsole.log(liquidityTokensWithBalances)\r\n  const formattedAmounts = {\r\n    [independentField]: typedValue,\r\n    [dependentField]: showWrap\r\n      ? parsedAmounts[independentField]?.toExact() ?? ''\r\n      : parsedAmounts[dependentField]?.toSignificant(6) ?? ''\r\n  }\r\n\r\n  const route = trade?.route\r\n  const userHasSpecifiedInputOutput = Boolean(\r\n    currencies[Field.INPUT] && parsedAmounts[independentField]?.greaterThan(JSBI.BigInt(0))\r\n  )\r\n\r\n\r\n  const noRoute = !route\r\n  const [allowedSlippage] = useUserSlippageTolerance()\r\n  // check whether the user has approved the router on the input token\r\n  const [approval, approveCallback] = useApproveCallbackFromTrade(trade, allowedSlippage)\r\n  console.log(userHasSpecifiedInputOutput, noRoute, approveCallback)\r\n  // check if user has gone through approval process, used to show two step buttons, reset on token change\r\n  const [approvalSubmitted, setApprovalSubmitted] = useState<boolean>(false)\r\n\r\n  // mark when a user has submitted an approval, reset onTokenSelection for input field\r\n  useEffect(() => {\r\n    if (approval === ApprovalState.PENDING) {\r\n      setApprovalSubmitted(true)\r\n    }\r\n  }, [approval, approvalSubmitted])\r\n\r\n\r\n\r\n\r\n  const handleInputSelect = useCallback(\r\n    inputCurrency => {\r\n      setApprovalSubmitted(false) // reset 2 step UI for approvals\r\n      onCurrencySelection(Field.INPUT, inputCurrency)\r\n    },\r\n    [onCurrencySelection]\r\n  )\r\n\r\n  const handleTypeInput = useCallback(\r\n    (value: string) => {\r\n      onUserInput(Field.INPUT, value)\r\n    },\r\n    [onUserInput]\r\n  )\r\n  const handleTypeOutput = useCallback(\r\n    (value: string) => {\r\n      onUserInput(Field.OUTPUT, value)\r\n    },\r\n    [onUserInput]\r\n  )\r\n  const maxAmountInput: CurrencyAmount | undefined = maxAmountSpend(currencyBalances[Field.INPUT])\r\n  const atMaxAmountInput = Boolean(maxAmountInput && parsedAmounts[Field.INPUT]?.equalTo(maxAmountInput))\r\n  const handleMaxInput = useCallback(() => {\r\n    alert('o')\r\n  }, [maxAmountInput, onUserInput])\r\n\r\n  console.log(Field.INPUT, handleTypeOutput, atMaxAmountInput, handleMaxInput, maxAmountInput, onUserInput, recipient)\r\n\r\n  async function replace() {\r\n  let imgLp =   await window.document.querySelector('#swap-currency-input2 > div > div.sc-cqCuEk.bFUFXO > button > span')\r\nif (imgLp) {\r\n imgLp.innerHTML = `<img src=\"http://localhost:3000/bananascoin.png\" width='34px;'></img><span style=\"padding-left: 0.3rem;\">BAN</span>`\r\n}\r\nconst provider = new ethers.providers.Web3Provider(window.ethereum)\r\nawait provider.send(\"eth_requestAccounts\", []);\r\nconst signer = provider.getSigner()\r\nconst signerAddress = await signer.getAddress()\r\nconsole.log(signerAddress)\r\nconst farmContract = new ethers.Contract(farmAddress, farmABI, provider);\r\nlet rewardsPerBlock = await farmContract.rewardPerBlock()\r\nrewardsPerBlock = ethers.utils.formatUnits(rewardsPerBlock, 18)\r\nlet APR = rewardsPerBlock * 1855058\r\nlet APRp = window.document.getElementById('apr')\r\nAPRp.innerText = `APY: ${Number(APR).toFixed(2)} %`\r\n\r\n  }\r\n  replace();\r\n\r\nasync function StakeLP() {\r\n  const provider2 = new ethers.providers.Web3Provider(window.ethereum)\r\n  await provider2.send(\"eth_requestAccounts\", []);\r\n  const signer2 = provider2.getSigner()\r\n  console.log(signer2)\r\n  let tokenAmount = await window.document.getElementsByClassName('token-amount-input')\r\n  const amountToDeposit = tokenAmount[0].value\r\n  const numberOfDecimals = 18\r\n  var spNb = ethers.utils.parseUnits(amountToDeposit, numberOfDecimals);\r\n  const farmContract = new ethers.Contract(farmAddress, farmABI, signer2);\r\n  const LPContract = new ethers.Contract(lpTokenAddress, lpTokenABI, signer2);\r\n  const Approve = await LPContract.approve(farmAddress, spNb)\r\n  const tx = await Approve.wait()\r\n  const event = tx.events[0];\r\n  const enterStaking = await farmContract.deposit(\"0\", spNb)\r\n  }\r\n  return (\r\n    <>\r\n     <AppBody >\r\n<StakeTabs active={'earn'} />\r\n<AutoColumn >\r\n  <img src=\"https://bananaswap.vercel.app/bananascoin.png\" width='150px' id='coinlogo'></img>\r\n<Text textAlign=\"center\" id=\"text\">Stake your LP tokens to get extra $BANANAS rewards</Text>\r\n<CurrencyInputPanel \r\n              label={independentField === Field.OUTPUT && !showWrap && trade ? 'From (estimated)' : 'From'}\r\n             value={formattedAmounts[Field.INPUT]}\r\n              currency={LP}\r\n              onUserInput={handleTypeInput}  \r\n              onCurrencySelect={handleInputSelect}\r\n              disableCurrencySelect={true}\r\n              showMaxButton={false}\r\n              showCommonBases\r\n              id=\"swap-currency-input2\"\r\n                    /*\r\n              otherCurrency={currencies[Field.OUTPUT]}\r\n              \r\n*/  \r\n            />\r\n    <ButtonPrimary id=\"join-pool-button\" onClick={StakeLP}>\r\n      <Text fontWeight={500} fontSize={20}>\r\n        {t('stakeLp')}\r\n      </Text>\r\n   \r\n    </ButtonPrimary>\r\n    <Text textAlign={'center'}>\r\n        2 transactions to complete\r\n      </Text>\r\n    <Text fontWeight={500} fontSize={20}>\r\n    <Text id=\"apr\"></Text> \r\n      </Text>\r\n      \r\n    <Stake />\r\n    </AutoColumn>\r\n    \r\n</AppBody>\r\n    </>\r\n  )\r\n}\r\n\r\n//465: {betterTradeLinkVersion && <BetterTradeLink version={betterTradeLinkVersion} />}\r\n"]},"metadata":{},"sourceType":"module"}