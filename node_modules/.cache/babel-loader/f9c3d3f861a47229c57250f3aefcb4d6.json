{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _defineProperty from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import{JSBI,Token,ChainId}from'moonbeamswap';import React,{useCallback,useEffect,useMemo,useState}from'react';import{Text}from'rebass';import{useTranslation}from'react-i18next';import{Link}from'react-router-dom';import{ButtonPrimary}from'../../components/Button';import{AutoColumn}from'../../components/Column';import CurrencyInputPanel from'../../components/CurrencyInputPanel';import{StakeTabs}from'../../components/NavigationTabs';import{useTokenBalancesWithLoadingIndicator}from'../../state/wallet/hooks';import{useActiveWeb3React}from'../../hooks';import{ApprovalState,useApproveCallbackFromTrade}from'../../hooks/useApproveCallback';import useToggledVersion,{Version}from'../../hooks/useToggledVersion';import useWrapCallback,{WrapType}from'../../hooks/useWrapCallback';import{Field}from'../../state/swap/actions';import{useDerivedSwapInfo,useSwapActionHandlers,useSwapState}from'../../state/swap/hooks';import{useUserSlippageTolerance}from'../../state/user/hooks';import{maxAmountSpend}from'../../utils/maxAmountSpend';import AppBody from'../AppBody';import{toV2LiquidityToken,useTrackedTokenPairs}from'../../state/user/hooks';import'.././style.css';import{ethers}from'ethers';import Stake from'./components/Stake';import{lpTokenAddress,farmAddress,lpTokenABI,farmABI}from'./conf.js';export default function Swap(){var _ref,_ref2,_parsedAmounts$indepe,_parsedAmounts$indepe2,_parsedAmounts$depend,_parsedAmounts$depend2,_formattedAmounts,_parsedAmounts$indepe3,_parsedAmounts$Field$;var _useTranslation=useTranslation(),t=_useTranslation.t;var _useActiveWeb3React=useActiveWeb3React(),account=_useActiveWeb3React.account;var LP=new Token(ChainId.MOONBASE,'0x205A1AecA18DDCB130825B961BcE897302690A5d',18,'BAN','Bananaswap');// swap state\nvar _useSwapState=useSwapState(),independentField=_useSwapState.independentField,typedValue=_useSwapState.typedValue,recipient=_useSwapState.recipient;var _useDerivedSwapInfo=useDerivedSwapInfo(),v2Trade=_useDerivedSwapInfo.v2Trade,currencyBalances=_useDerivedSwapInfo.currencyBalances,parsedAmount=_useDerivedSwapInfo.parsedAmount,currencies=_useDerivedSwapInfo.currencies,swapInputError=_useDerivedSwapInfo.inputError;var _useWrapCallback=useWrapCallback(currencies[Field.INPUT],currencies[Field.OUTPUT],typedValue),wrapType=_useWrapCallback.wrapType,onWrap=_useWrapCallback.execute,wrapInputError=_useWrapCallback.inputError;console.log(onWrap);console.log(currencies,wrapInputError);var showWrap=wrapType!==WrapType.NOT_APPLICABLE;var toggledVersion=useToggledVersion();var trade=showWrap?undefined:_defineProperty({},Version.v2,v2Trade)[toggledVersion];var parsedAmounts=showWrap?(_ref={},_defineProperty(_ref,Field.INPUT,parsedAmount),_defineProperty(_ref,Field.OUTPUT,parsedAmount),_ref):(_ref2={},_defineProperty(_ref2,Field.INPUT,independentField===Field.INPUT?parsedAmount:trade===null||trade===void 0?void 0:trade.inputAmount),_defineProperty(_ref2,Field.OUTPUT,independentField===Field.OUTPUT?parsedAmount:trade===null||trade===void 0?void 0:trade.outputAmount),_ref2);var _useSwapActionHandler=useSwapActionHandlers(),onSwitchTokens=_useSwapActionHandler.onSwitchTokens,onCurrencySelection=_useSwapActionHandler.onCurrencySelection,onUserInput=_useSwapActionHandler.onUserInput,onChangeRecipient=_useSwapActionHandler.onChangeRecipient;var isValid=!swapInputError;var dependentField=independentField===Field.INPUT?Field.OUTPUT:Field.INPUT;console.log(onSwitchTokens,isValid,onChangeRecipient);var trackedTokenPairs=useTrackedTokenPairs();var tokenPairsWithLiquidityTokens=useMemo(function(){return trackedTokenPairs.map(function(tokens){return{liquidityToken:toV2LiquidityToken(tokens),tokens:tokens};});},[trackedTokenPairs]);var liquidityTokens=useMemo(function(){return tokenPairsWithLiquidityTokens.map(function(tpwlt){return tpwlt.liquidityToken;});},[tokenPairsWithLiquidityTokens]);var _useTokenBalancesWith=useTokenBalancesWithLoadingIndicator(account!==null&&account!==void 0?account:undefined,liquidityTokens),_useTokenBalancesWith2=_slicedToArray(_useTokenBalancesWith,2),v2PairsBalances=_useTokenBalancesWith2[0],fetchingV2PairBalances=_useTokenBalancesWith2[1];console.log(fetchingV2PairBalances);// fetch the reserves for all V2 pools in which the user has a balance\nvar liquidityTokensWithBalances=useMemo(function(){return tokenPairsWithLiquidityTokens.filter(function(_ref3){var _v2PairsBalances$liqu;var liquidityToken=_ref3.liquidityToken;return(_v2PairsBalances$liqu=v2PairsBalances[liquidityToken.address])===null||_v2PairsBalances$liqu===void 0?void 0:_v2PairsBalances$liqu.greaterThan('0');});},[tokenPairsWithLiquidityTokens,v2PairsBalances]);console.log(liquidityTokensWithBalances);var formattedAmounts=(_formattedAmounts={},_defineProperty(_formattedAmounts,independentField,typedValue),_defineProperty(_formattedAmounts,dependentField,showWrap?(_parsedAmounts$indepe=(_parsedAmounts$indepe2=parsedAmounts[independentField])===null||_parsedAmounts$indepe2===void 0?void 0:_parsedAmounts$indepe2.toExact())!==null&&_parsedAmounts$indepe!==void 0?_parsedAmounts$indepe:'':(_parsedAmounts$depend=(_parsedAmounts$depend2=parsedAmounts[dependentField])===null||_parsedAmounts$depend2===void 0?void 0:_parsedAmounts$depend2.toSignificant(6))!==null&&_parsedAmounts$depend!==void 0?_parsedAmounts$depend:''),_formattedAmounts);var route=trade===null||trade===void 0?void 0:trade.route;var userHasSpecifiedInputOutput=Boolean(currencies[Field.INPUT]&&((_parsedAmounts$indepe3=parsedAmounts[independentField])===null||_parsedAmounts$indepe3===void 0?void 0:_parsedAmounts$indepe3.greaterThan(JSBI.BigInt(0))));var noRoute=!route;var _useUserSlippageToler=useUserSlippageTolerance(),_useUserSlippageToler2=_slicedToArray(_useUserSlippageToler,1),allowedSlippage=_useUserSlippageToler2[0];// check whether the user has approved the router on the input token\nvar _useApproveCallbackFr=useApproveCallbackFromTrade(trade,allowedSlippage),_useApproveCallbackFr2=_slicedToArray(_useApproveCallbackFr,2),approval=_useApproveCallbackFr2[0],approveCallback=_useApproveCallbackFr2[1];console.log(userHasSpecifiedInputOutput,noRoute,approveCallback);// check if user has gone through approval process, used to show two step buttons, reset on token change\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),approvalSubmitted=_useState2[0],setApprovalSubmitted=_useState2[1];// mark when a user has submitted an approval, reset onTokenSelection for input field\nuseEffect(function(){if(approval===ApprovalState.PENDING){setApprovalSubmitted(true);}},[approval,approvalSubmitted]);var handleInputSelect=useCallback(function(inputCurrency){setApprovalSubmitted(false);// reset 2 step UI for approvals\nonCurrencySelection(Field.INPUT,inputCurrency);},[onCurrencySelection]);var handleTypeInput=useCallback(function(value){onUserInput(Field.INPUT,value);},[onUserInput]);var handleTypeOutput=useCallback(function(value){onUserInput(Field.OUTPUT,value);},[onUserInput]);var maxAmountInput=maxAmountSpend(currencyBalances[Field.INPUT]);var atMaxAmountInput=Boolean(maxAmountInput&&((_parsedAmounts$Field$=parsedAmounts[Field.INPUT])===null||_parsedAmounts$Field$===void 0?void 0:_parsedAmounts$Field$.equalTo(maxAmountInput)));var handleMaxInput=useCallback(function(){alert('o');},[maxAmountInput,onUserInput]);console.log(Field.INPUT,handleTypeOutput,atMaxAmountInput,handleMaxInput,maxAmountInput,onUserInput,recipient);function replace(){return _replace.apply(this,arguments);}function _replace(){_replace=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var imgLp,provider,signer,signerAddress,farmContract,rewardsPerBlock,APR,APRp;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return window.document.querySelector('#swap-currency-input2 > div > div.sc-cqCuEk.bFUFXO > button > span');case 2:imgLp=_context.sent;if(imgLp){imgLp.innerHTML=\"<img src=\\\"http://localhost:3000/bananascoin.png\\\" width='34px;'></img><span style=\\\"padding-left: 0.3rem;\\\">BAN</span>\";}provider=new ethers.providers.Web3Provider(window.ethereum);_context.next=7;return provider.send(\"eth_requestAccounts\",[]);case 7:signer=provider.getSigner();_context.next=10;return signer.getAddress();case 10:signerAddress=_context.sent;console.log(signerAddress);farmContract=new ethers.Contract(farmAddress,farmABI,provider);_context.next=15;return farmContract.rewardPerBlock();case 15:rewardsPerBlock=_context.sent;rewardsPerBlock=ethers.utils.formatUnits(rewardsPerBlock,18);APR=rewardsPerBlock*1855058;APRp=window.document.getElementById('apr');APRp.innerText=\"APY: \".concat(Number(APR).toFixed(2),\" %\");case 20:case\"end\":return _context.stop();}}},_callee);}));return _replace.apply(this,arguments);}replace();function StakeLP(){return _StakeLP.apply(this,arguments);}function _StakeLP(){_StakeLP=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var provider2,signer2,tokenAmount,amountToDeposit,numberOfDecimals,spNb,farmContract,LPContract,Approve,tx,event,enterStaking;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:provider2=new ethers.providers.Web3Provider(window.ethereum);_context2.next=3;return provider2.send(\"eth_requestAccounts\",[]);case 3:signer2=provider2.getSigner();console.log(signer2);_context2.next=7;return window.document.getElementsByClassName('token-amount-input');case 7:tokenAmount=_context2.sent;amountToDeposit=tokenAmount[0].value;numberOfDecimals=18;spNb=ethers.utils.parseUnits(amountToDeposit,numberOfDecimals);farmContract=new ethers.Contract(farmAddress,farmABI,signer2);LPContract=new ethers.Contract(lpTokenAddress,lpTokenABI,signer2);_context2.next=15;return LPContract.approve(farmAddress,spNb);case 15:Approve=_context2.sent;_context2.next=18;return Approve.wait();case 18:tx=_context2.sent;event=tx.events[0];_context2.next=22;return farmContract.deposit(\"0\",spNb);case 22:enterStaking=_context2.sent;case 23:case\"end\":return _context2.stop();}}},_callee2);}));return _StakeLP.apply(this,arguments);}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(AppBody,null,/*#__PURE__*/React.createElement(StakeTabs,{active:'earn'}),/*#__PURE__*/React.createElement(AutoColumn,null,/*#__PURE__*/React.createElement(\"img\",{src:\"http://localhost:3000/bananascoin.png\",width:\"150px\"}),/*#__PURE__*/React.createElement(Text,{textAlign:\"center\"},\"Stake your LP tokens to get extra $BANANAS rewards\"),/*#__PURE__*/React.createElement(CurrencyInputPanel,{label:independentField===Field.OUTPUT&&!showWrap&&trade?'From (estimated)':'From',value:formattedAmounts[Field.INPUT],currency:LP,onUserInput:handleTypeInput,onCurrencySelect:handleInputSelect,disableCurrencySelect:true,showMaxButton:false,showCommonBases:true,id:\"swap-currency-input2\"/*\r\n              otherCurrency={currencies[Field.OUTPUT]}\r\n              \r\n*/}),/*#__PURE__*/React.createElement(ButtonPrimary,{id:\"join-pool-button\",as:Link,style:{padding:16},onClick:StakeLP},/*#__PURE__*/React.createElement(Text,{fontWeight:500,fontSize:20},t('stakeLp'))),/*#__PURE__*/React.createElement(Text,null,\"2 transactions to complete\"),/*#__PURE__*/React.createElement(Text,{fontWeight:500,fontSize:20},/*#__PURE__*/React.createElement(Text,{id:\"apr\"})),/*#__PURE__*/React.createElement(Stake,null))));}//465: {betterTradeLinkVersion && <BetterTradeLink version={betterTradeLinkVersion} />}","map":{"version":3,"sources":["C:/Users/marin/Desktop/bananaswap/src/pages/Earn/index.tsx"],"names":["JSBI","Token","ChainId","React","useCallback","useEffect","useMemo","useState","Text","useTranslation","Link","ButtonPrimary","AutoColumn","CurrencyInputPanel","StakeTabs","useTokenBalancesWithLoadingIndicator","useActiveWeb3React","ApprovalState","useApproveCallbackFromTrade","useToggledVersion","Version","useWrapCallback","WrapType","Field","useDerivedSwapInfo","useSwapActionHandlers","useSwapState","useUserSlippageTolerance","maxAmountSpend","AppBody","toV2LiquidityToken","useTrackedTokenPairs","ethers","Stake","lpTokenAddress","farmAddress","lpTokenABI","farmABI","Swap","t","account","LP","MOONBASE","independentField","typedValue","recipient","v2Trade","currencyBalances","parsedAmount","currencies","swapInputError","inputError","INPUT","OUTPUT","wrapType","onWrap","execute","wrapInputError","console","log","showWrap","NOT_APPLICABLE","toggledVersion","trade","undefined","v2","parsedAmounts","inputAmount","outputAmount","onSwitchTokens","onCurrencySelection","onUserInput","onChangeRecipient","isValid","dependentField","trackedTokenPairs","tokenPairsWithLiquidityTokens","map","tokens","liquidityToken","liquidityTokens","tpwlt","v2PairsBalances","fetchingV2PairBalances","liquidityTokensWithBalances","filter","address","greaterThan","formattedAmounts","toExact","toSignificant","route","userHasSpecifiedInputOutput","Boolean","BigInt","noRoute","allowedSlippage","approval","approveCallback","approvalSubmitted","setApprovalSubmitted","PENDING","handleInputSelect","inputCurrency","handleTypeInput","value","handleTypeOutput","maxAmountInput","atMaxAmountInput","equalTo","handleMaxInput","alert","replace","window","document","querySelector","imgLp","innerHTML","provider","providers","Web3Provider","ethereum","send","signer","getSigner","getAddress","signerAddress","farmContract","Contract","rewardPerBlock","rewardsPerBlock","utils","formatUnits","APR","APRp","getElementById","innerText","Number","toFixed","StakeLP","provider2","signer2","getElementsByClassName","tokenAmount","amountToDeposit","numberOfDecimals","spNb","parseUnits","LPContract","approve","Approve","wait","tx","event","events","deposit","enterStaking","padding"],"mappings":"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","sourcesContent":["import { CurrencyAmount, JSBI, Token, ChainId } from 'moonbeamswap'\r\nimport React, { useCallback, useEffect, useMemo, useState } from 'react'\r\nimport { Text } from 'rebass'\r\nimport { useTranslation } from 'react-i18next'\r\nimport { Link } from 'react-router-dom'\r\nimport { ButtonPrimary } from '../../components/Button'\r\nimport { AutoColumn } from '../../components/Column'\r\nimport CurrencyInputPanel from '../../components/CurrencyInputPanel'\r\nimport { StakeTabs } from '../../components/NavigationTabs'\r\nimport { useTokenBalancesWithLoadingIndicator } from '../../state/wallet/hooks'\r\nimport { useActiveWeb3React } from '../../hooks'\r\nimport { ApprovalState, useApproveCallbackFromTrade } from '../../hooks/useApproveCallback'\r\nimport useToggledVersion, { Version } from '../../hooks/useToggledVersion'\r\nimport useWrapCallback, { WrapType } from '../../hooks/useWrapCallback'\r\nimport { Field } from '../../state/swap/actions'\r\nimport {\r\n  useDerivedSwapInfo,\r\n  useSwapActionHandlers,\r\n  useSwapState\r\n} from '../../state/swap/hooks'\r\nimport { useUserSlippageTolerance } from '../../state/user/hooks'\r\nimport { maxAmountSpend } from '../../utils/maxAmountSpend'\r\nimport AppBody from '../AppBody'\r\nimport { toV2LiquidityToken, useTrackedTokenPairs } from '../../state/user/hooks'\r\nimport '.././style.css'\r\nimport { ethers } from 'ethers'\r\n\r\nimport Stake from './components/Stake'\r\nimport { lpTokenAddress, farmAddress, lpTokenABI, farmABI} from './conf.js'\r\n\r\ndeclare let window: any;\r\n\r\nexport default function Swap() {\r\n  const { t } = useTranslation()\r\n  const { account } = useActiveWeb3React()\r\n\r\n const LP = new Token(ChainId.MOONBASE, '0x205A1AecA18DDCB130825B961BcE897302690A5d', 18, 'BAN', 'Bananaswap')\r\n\r\n    // swap state\r\n    const { independentField, typedValue, recipient } = useSwapState()\r\n    const { v2Trade, currencyBalances, parsedAmount, currencies, inputError: swapInputError } = useDerivedSwapInfo()\r\n    const { wrapType, execute: onWrap, inputError: wrapInputError } = useWrapCallback(\r\n      currencies[Field.INPUT],\r\n      currencies[Field.OUTPUT],\r\n      typedValue\r\n    )\r\n    console.log(onWrap)\r\n    console.log(currencies, wrapInputError)\r\n    const showWrap: boolean = wrapType !== WrapType.NOT_APPLICABLE\r\n    const toggledVersion = useToggledVersion()\r\n    const trade = showWrap\r\n      ? undefined\r\n      : {\r\n          [Version.v2]: v2Trade\r\n        }[toggledVersion]\r\n  \r\n    const parsedAmounts = showWrap\r\n      ? {\r\n          [Field.INPUT]: parsedAmount,\r\n          [Field.OUTPUT]: parsedAmount\r\n        }\r\n      : {\r\n          [Field.INPUT]: independentField === Field.INPUT ? parsedAmount : trade?.inputAmount,\r\n          [Field.OUTPUT]: independentField === Field.OUTPUT ? parsedAmount : trade?.outputAmount\r\n        }\r\n  \r\n    const { onSwitchTokens, onCurrencySelection, onUserInput, onChangeRecipient } = useSwapActionHandlers()\r\n    const isValid = !swapInputError\r\n    const dependentField: Field = independentField === Field.INPUT ? Field.OUTPUT : Field.INPUT\r\n    console.log(onSwitchTokens,isValid,onChangeRecipient)\r\n\r\n  const trackedTokenPairs = useTrackedTokenPairs()\r\n  const tokenPairsWithLiquidityTokens = useMemo(\r\n    () => trackedTokenPairs.map(tokens => ({ liquidityToken: toV2LiquidityToken(tokens), tokens })),\r\n    [trackedTokenPairs]\r\n  )\r\n  const liquidityTokens = useMemo(() => tokenPairsWithLiquidityTokens.map(tpwlt => tpwlt.liquidityToken), [\r\n    tokenPairsWithLiquidityTokens\r\n  ])\r\n  const [v2PairsBalances, fetchingV2PairBalances] = useTokenBalancesWithLoadingIndicator(\r\n    account ?? undefined,\r\n    liquidityTokens\r\n  )\r\n  console.log(fetchingV2PairBalances)\r\n  // fetch the reserves for all V2 pools in which the user has a balance\r\n  const liquidityTokensWithBalances = useMemo(\r\n    () =>\r\n      tokenPairsWithLiquidityTokens.filter(({ liquidityToken }) =>\r\n        v2PairsBalances[liquidityToken.address]?.greaterThan('0')\r\n      ),\r\n    [tokenPairsWithLiquidityTokens, v2PairsBalances]\r\n  )\r\nconsole.log(liquidityTokensWithBalances)\r\n  const formattedAmounts = {\r\n    [independentField]: typedValue,\r\n    [dependentField]: showWrap\r\n      ? parsedAmounts[independentField]?.toExact() ?? ''\r\n      : parsedAmounts[dependentField]?.toSignificant(6) ?? ''\r\n  }\r\n\r\n  const route = trade?.route\r\n  const userHasSpecifiedInputOutput = Boolean(\r\n    currencies[Field.INPUT] && parsedAmounts[independentField]?.greaterThan(JSBI.BigInt(0))\r\n  )\r\n\r\n\r\n  const noRoute = !route\r\n  const [allowedSlippage] = useUserSlippageTolerance()\r\n  // check whether the user has approved the router on the input token\r\n  const [approval, approveCallback] = useApproveCallbackFromTrade(trade, allowedSlippage)\r\n  console.log(userHasSpecifiedInputOutput, noRoute, approveCallback)\r\n  // check if user has gone through approval process, used to show two step buttons, reset on token change\r\n  const [approvalSubmitted, setApprovalSubmitted] = useState<boolean>(false)\r\n\r\n  // mark when a user has submitted an approval, reset onTokenSelection for input field\r\n  useEffect(() => {\r\n    if (approval === ApprovalState.PENDING) {\r\n      setApprovalSubmitted(true)\r\n    }\r\n  }, [approval, approvalSubmitted])\r\n\r\n\r\n\r\n\r\n  const handleInputSelect = useCallback(\r\n    inputCurrency => {\r\n      setApprovalSubmitted(false) // reset 2 step UI for approvals\r\n      onCurrencySelection(Field.INPUT, inputCurrency)\r\n    },\r\n    [onCurrencySelection]\r\n  )\r\n\r\n  const handleTypeInput = useCallback(\r\n    (value: string) => {\r\n      onUserInput(Field.INPUT, value)\r\n    },\r\n    [onUserInput]\r\n  )\r\n  const handleTypeOutput = useCallback(\r\n    (value: string) => {\r\n      onUserInput(Field.OUTPUT, value)\r\n    },\r\n    [onUserInput]\r\n  )\r\n  const maxAmountInput: CurrencyAmount | undefined = maxAmountSpend(currencyBalances[Field.INPUT])\r\n  const atMaxAmountInput = Boolean(maxAmountInput && parsedAmounts[Field.INPUT]?.equalTo(maxAmountInput))\r\n  const handleMaxInput = useCallback(() => {\r\n    alert('o')\r\n  }, [maxAmountInput, onUserInput])\r\n\r\n  console.log(Field.INPUT, handleTypeOutput, atMaxAmountInput, handleMaxInput, maxAmountInput, onUserInput, recipient)\r\n\r\n  async function replace() {\r\n  let imgLp =   await window.document.querySelector('#swap-currency-input2 > div > div.sc-cqCuEk.bFUFXO > button > span')\r\nif (imgLp) {\r\n imgLp.innerHTML = `<img src=\"http://localhost:3000/bananascoin.png\" width='34px;'></img><span style=\"padding-left: 0.3rem;\">BAN</span>`\r\n}\r\nconst provider = new ethers.providers.Web3Provider(window.ethereum)\r\nawait provider.send(\"eth_requestAccounts\", []);\r\nconst signer = provider.getSigner()\r\nconst signerAddress = await signer.getAddress()\r\nconsole.log(signerAddress)\r\nconst farmContract = new ethers.Contract(farmAddress, farmABI, provider);\r\nlet rewardsPerBlock = await farmContract.rewardPerBlock()\r\nrewardsPerBlock = ethers.utils.formatUnits(rewardsPerBlock, 18)\r\nlet APR = rewardsPerBlock * 1855058\r\nlet APRp = window.document.getElementById('apr')\r\nAPRp.innerText = `APY: ${Number(APR).toFixed(2)} %`\r\n\r\n  }\r\n  replace();\r\n\r\nasync function StakeLP() {\r\n  const provider2 = new ethers.providers.Web3Provider(window.ethereum)\r\n  await provider2.send(\"eth_requestAccounts\", []);\r\n  const signer2 = provider2.getSigner()\r\n  console.log(signer2)\r\n  let tokenAmount = await window.document.getElementsByClassName('token-amount-input')\r\n  const amountToDeposit = tokenAmount[0].value\r\n  const numberOfDecimals = 18\r\n  var spNb = ethers.utils.parseUnits(amountToDeposit, numberOfDecimals);\r\n  const farmContract = new ethers.Contract(farmAddress, farmABI, signer2);\r\n  const LPContract = new ethers.Contract(lpTokenAddress, lpTokenABI, signer2);\r\n  const Approve = await LPContract.approve(farmAddress, spNb)\r\n  const tx = await Approve.wait()\r\n  const event = tx.events[0];\r\n  const enterStaking = await farmContract.deposit(\"0\", spNb)\r\n  }\r\n  return (\r\n    <>\r\n     <AppBody>\r\n<StakeTabs active={'earn'} />\r\n<AutoColumn >\r\n  <img src=\"http://localhost:3000/bananascoin.png\" width='150px'></img>\r\n<Text textAlign=\"center\">Stake your LP tokens to get extra $BANANAS rewards</Text>\r\n<CurrencyInputPanel \r\n              label={independentField === Field.OUTPUT && !showWrap && trade ? 'From (estimated)' : 'From'}\r\n             value={formattedAmounts[Field.INPUT]}\r\n              currency={LP}\r\n              onUserInput={handleTypeInput}  \r\n              onCurrencySelect={handleInputSelect}\r\n              disableCurrencySelect={true}\r\n              showMaxButton={false}\r\n              showCommonBases\r\n              id=\"swap-currency-input2\"\r\n                    /*\r\n              otherCurrency={currencies[Field.OUTPUT]}\r\n              \r\n*/  \r\n            />\r\n    <ButtonPrimary id=\"join-pool-button\" as={Link} style={{ padding: 16 }} onClick={StakeLP}>\r\n      <Text fontWeight={500} fontSize={20}>\r\n        {t('stakeLp')}\r\n      </Text>\r\n   \r\n    </ButtonPrimary>\r\n    <Text>\r\n        2 transactions to complete\r\n      </Text>\r\n    <Text fontWeight={500} fontSize={20}>\r\n    <Text id=\"apr\"></Text> \r\n      </Text>\r\n      \r\n    <Stake />\r\n    </AutoColumn>\r\n    \r\n</AppBody>\r\n    </>\r\n  )\r\n}\r\n\r\n//465: {betterTradeLinkVersion && <BetterTradeLink version={betterTradeLinkVersion} />}\r\n"]},"metadata":{},"sourceType":"module"}