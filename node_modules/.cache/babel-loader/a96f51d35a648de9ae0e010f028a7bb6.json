{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import _taggedTemplateLiteral from\"C:\\\\Users\\\\marin\\\\Desktop\\\\bananaswap\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13;import React,{useState,useEffect}from'react';import ReactGA from'react-ga';import styled from'styled-components';import{isMobile}from'react-device-detect';import{UnsupportedChainIdError,useWeb3React}from'@web3-react/core';import usePrevious from'../../hooks/usePrevious';import{useWalletModalOpen,useWalletModalToggle}from'../../state/application/hooks';import Modal from'../Modal';import AccountDetails from'../AccountDetails';import PendingView from'./PendingView';import Option from'./Option';import{SUPPORTED_WALLETS}from'../../constants';import{ExternalLink}from'../../theme';import MetamaskIcon from'../../assets/images/metamask.png';import{ReactComponent as Close}from\"@svgr/webpack?-svgo,+titleProp,+ref!../../assets/images/x.svg\";import{injected,fortmatic,portis}from'../../connectors';import{OVERLAY_READY}from'../../connectors/Fortmatic';import{WalletConnectConnector}from'@web3-react/walletconnect-connector';var CloseIcon=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  right: 1rem;\\n  top: 14px;\\n  &:hover {\\n    cursor: pointer;\\n    opacity: 0.6;\\n  }\\n\"])));var CloseColor=styled(Close)(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  path {\\n    stroke: \",\";\\n  }\\n\"])),function(_ref){var theme=_ref.theme;return theme.text4;});var Wrapper=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  \",\"\\n  margin: 0;\\n  padding: 0;\\n  width: 100%;\\n\"])),function(_ref2){var theme=_ref2.theme;return theme.flexColumnNoWrap;});var HeaderRow=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  \",\";\\n  padding: 1rem 1rem;\\n  font-weight: 500;\\n  color: \",\";\\n  \",\";\\n\"])),function(_ref3){var theme=_ref3.theme;return theme.flexRowNoWrap;},function(props){return props.color==='blue'?function(_ref4){var theme=_ref4.theme;return theme.primary1;}:'inherit';},function(_ref5){var theme=_ref5.theme;return theme.mediaWidth.upToMedium(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n    padding: 1rem;\\n  \"])));});var ContentWrapper=styled.div(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  background-color: \",\";\\n  padding: 2rem;\\n  border-bottom-left-radius: 20px;\\n  border-bottom-right-radius: 20px;\\n\\n  \",\";\\n\"])),function(_ref6){var theme=_ref6.theme;return theme.bg2;},function(_ref7){var theme=_ref7.theme;return theme.mediaWidth.upToMedium(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"padding: 1rem\"])));});var UpperSection=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  position: relative;\\n\\n  h5 {\\n    margin: 0;\\n    margin-bottom: 0.5rem;\\n    font-size: 1rem;\\n    font-weight: 400;\\n  }\\n\\n  h5:last-child {\\n    margin-bottom: 0px;\\n  }\\n\\n  h4 {\\n    margin-top: 0;\\n    font-weight: 500;\\n  }\\n\"])));var Blurb=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  \",\"\\n  align-items: center;\\n  justify-content: center;\\n  flex-wrap: wrap;\\n  margin-top: 2rem;\\n  \",\";\\n\"])),function(_ref8){var theme=_ref8.theme;return theme.flexRowNoWrap;},function(_ref9){var theme=_ref9.theme;return theme.mediaWidth.upToMedium(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n    margin: 1rem;\\n    font-size: 12px;\\n  \"])));});var OptionGrid=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  display: grid;\\n  grid-gap: 10px;\\n  \",\";\\n\"])),function(_ref10){var theme=_ref10.theme;return theme.mediaWidth.upToMedium(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n    grid-template-columns: 1fr;\\n    grid-gap: 10px;\\n  \"])));});var HoverText=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  :hover {\\n    cursor: pointer;\\n  }\\n\"])));var WALLET_VIEWS={OPTIONS:'options',OPTIONS_SECONDARY:'options_secondary',ACCOUNT:'account',PENDING:'pending'};export default function WalletModal(_ref11){var pendingTransactions=_ref11.pendingTransactions,confirmedTransactions=_ref11.confirmedTransactions,ENSName=_ref11.ENSName;var _useWeb3React=useWeb3React(),active=_useWeb3React.active,account=_useWeb3React.account,connector=_useWeb3React.connector,activate=_useWeb3React.activate,error=_useWeb3React.error;var _useState=useState(WALLET_VIEWS.ACCOUNT),_useState2=_slicedToArray(_useState,2),walletView=_useState2[0],setWalletView=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),pendingWallet=_useState4[0],setPendingWallet=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),pendingError=_useState6[0],setPendingError=_useState6[1];var walletModalOpen=useWalletModalOpen();var toggleWalletModal=useWalletModalToggle();var previousAccount=usePrevious(account);// close on connection, when logged out before\nuseEffect(function(){if(account&&!previousAccount&&walletModalOpen){toggleWalletModal();}},[account,previousAccount,toggleWalletModal,walletModalOpen]);// always reset to account view\nuseEffect(function(){if(walletModalOpen){setPendingError(false);setWalletView(WALLET_VIEWS.ACCOUNT);}},[walletModalOpen]);// close modal when a connection is successful\nvar activePrevious=usePrevious(active);var connectorPrevious=usePrevious(connector);useEffect(function(){if(walletModalOpen&&(active&&!activePrevious||connector&&connector!==connectorPrevious&&!error)){setWalletView(WALLET_VIEWS.ACCOUNT);}},[setWalletView,active,error,connector,walletModalOpen,activePrevious,connectorPrevious]);var tryActivation=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(connector){var _connector$walletConn,_connector$walletConn2;var name;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:name='';Object.keys(SUPPORTED_WALLETS).map(function(key){if(connector===SUPPORTED_WALLETS[key].connector){return name=SUPPORTED_WALLETS[key].name;}return true;});// log selected wallet\nReactGA.event({category:'Wallet',action:'Change Wallet',label:name});setPendingWallet(connector);// set wallet for pending view\nsetWalletView(WALLET_VIEWS.PENDING);// if the connector is walletconnect and the user has already tried to connect, manually reset the connector\nif(connector instanceof WalletConnectConnector&&((_connector$walletConn=connector.walletConnectProvider)===null||_connector$walletConn===void 0?void 0:(_connector$walletConn2=_connector$walletConn.wc)===null||_connector$walletConn2===void 0?void 0:_connector$walletConn2.uri)){connector.walletConnectProvider=undefined;}connector&&activate(connector,undefined,true).catch(function(error){if(error instanceof UnsupportedChainIdError){activate(connector);// a little janky...can't use setError because the connector isn't set\n}else{setPendingError(true);}});case 7:case\"end\":return _context.stop();}}},_callee);}));return function tryActivation(_x){return _ref12.apply(this,arguments);};}();// close wallet modal if fortmatic modal is active\nuseEffect(function(){fortmatic.on(OVERLAY_READY,function(){toggleWalletModal();});},[toggleWalletModal]);// get wallets user can switch too, depending on device/browser\nfunction getOptions(){var isMetamask=window.ethereum&&window.ethereum.isMetaMask;return Object.keys(SUPPORTED_WALLETS).map(function(key){var option=SUPPORTED_WALLETS[key];// check for mobile options\nif(isMobile){//disable portis on mobile for now\nif(option.connector===portis){return null;}if(!window.web3&&!window.ethereum&&option.mobile){return/*#__PURE__*/React.createElement(Option,{onClick:function onClick(){option.connector!==connector&&!option.href&&tryActivation(option.connector);},id:\"connect-\".concat(key),key:key,active:option.connector&&option.connector===connector,color:option.color,link:option.href,header:option.name,subheader:null,icon:require('../../assets/images/'+option.iconName)});}return null;}// overwrite injected when needed\nif(option.connector===injected){// don't show injected if there's no injected provider\nif(!(window.web3||window.ethereum)){if(option.name==='MetaMask'){return/*#__PURE__*/React.createElement(Option,{id:\"connect-\".concat(key),key:key,color:'#E8831D',header:'Install Metamask',subheader:null,link:'https://metamask.io/',icon:MetamaskIcon});}else{return null;//dont want to return install twice\n}}// don't return metamask if injected provider isn't metamask\nelse if(option.name==='MetaMask'&&!isMetamask){return null;}// likewise for generic\nelse if(option.name==='Injected'&&isMetamask){return null;}}// return rest of options\nreturn!isMobile&&!option.mobileOnly&&/*#__PURE__*/React.createElement(Option,{id:\"connect-\".concat(key),onClick:function onClick(){option.connector===connector?setWalletView(WALLET_VIEWS.ACCOUNT):!option.href&&tryActivation(option.connector);},key:key,active:option.connector===connector,color:option.color,link:option.href,header:option.name,subheader:null//use option.descriptio to bring back multi-line\n,icon:require('../../assets/images/'+option.iconName)});});}function getModalContent(){if(error){return/*#__PURE__*/React.createElement(UpperSection,null,/*#__PURE__*/React.createElement(CloseIcon,{onClick:toggleWalletModal},/*#__PURE__*/React.createElement(CloseColor,null)),/*#__PURE__*/React.createElement(HeaderRow,null,error instanceof UnsupportedChainIdError?'Wrong Network':'Error connecting'),/*#__PURE__*/React.createElement(ContentWrapper,null,error instanceof UnsupportedChainIdError?/*#__PURE__*/React.createElement(\"h5\",null,\"Please connect to the appropriate Ethereum network.\"):'Error connecting. Try refreshing the page.'));}if(account&&walletView===WALLET_VIEWS.ACCOUNT){return/*#__PURE__*/React.createElement(AccountDetails,{toggleWalletModal:toggleWalletModal,pendingTransactions:pendingTransactions,confirmedTransactions:confirmedTransactions,ENSName:ENSName,openOptions:function openOptions(){return setWalletView(WALLET_VIEWS.OPTIONS);}});}return/*#__PURE__*/React.createElement(UpperSection,null,/*#__PURE__*/React.createElement(CloseIcon,{onClick:toggleWalletModal},/*#__PURE__*/React.createElement(CloseColor,null)),walletView!==WALLET_VIEWS.ACCOUNT?/*#__PURE__*/React.createElement(HeaderRow,{color:\"blue\"},/*#__PURE__*/React.createElement(HoverText,{onClick:function onClick(){setPendingError(false);setWalletView(WALLET_VIEWS.ACCOUNT);}},\"Back\")):/*#__PURE__*/React.createElement(HeaderRow,null,/*#__PURE__*/React.createElement(HoverText,null,\"Connect to a wallet\")),/*#__PURE__*/React.createElement(ContentWrapper,null,walletView===WALLET_VIEWS.PENDING?/*#__PURE__*/React.createElement(PendingView,{connector:pendingWallet,error:pendingError,setPendingError:setPendingError,tryActivation:tryActivation}):/*#__PURE__*/React.createElement(OptionGrid,null,getOptions()),walletView!==WALLET_VIEWS.PENDING&&/*#__PURE__*/React.createElement(Blurb,null,/*#__PURE__*/React.createElement(\"span\",null,\"New to Ethereum? \\xA0\"),' ',/*#__PURE__*/React.createElement(ExternalLink,{href:\"https://ethereum.org/wallets/\"},\"Learn more about wallets\"))));}return/*#__PURE__*/React.createElement(Modal,{isOpen:walletModalOpen,onDismiss:toggleWalletModal,minHeight:false,maxHeight:90},/*#__PURE__*/React.createElement(Wrapper,null,getModalContent()));}","map":{"version":3,"sources":["C:/Users/marin/Desktop/bananaswap/src/components/WalletModal/index.tsx"],"names":["React","useState","useEffect","ReactGA","styled","isMobile","UnsupportedChainIdError","useWeb3React","usePrevious","useWalletModalOpen","useWalletModalToggle","Modal","AccountDetails","PendingView","Option","SUPPORTED_WALLETS","ExternalLink","MetamaskIcon","injected","fortmatic","portis","OVERLAY_READY","WalletConnectConnector","CloseIcon","div","CloseColor","Close","theme","text4","Wrapper","flexColumnNoWrap","HeaderRow","flexRowNoWrap","props","color","primary1","mediaWidth","upToMedium","ContentWrapper","bg2","UpperSection","Blurb","OptionGrid","HoverText","WALLET_VIEWS","OPTIONS","OPTIONS_SECONDARY","ACCOUNT","PENDING","WalletModal","pendingTransactions","confirmedTransactions","ENSName","active","account","connector","activate","error","walletView","setWalletView","pendingWallet","setPendingWallet","pendingError","setPendingError","walletModalOpen","toggleWalletModal","previousAccount","activePrevious","connectorPrevious","tryActivation","name","Object","keys","map","key","event","category","action","label","walletConnectProvider","wc","uri","undefined","catch","on","getOptions","isMetamask","window","ethereum","isMetaMask","option","web3","mobile","href","require","iconName","mobileOnly","getModalContent"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport ReactGA from 'react-ga'\r\nimport styled from 'styled-components'\r\nimport { isMobile } from 'react-device-detect'\r\nimport { UnsupportedChainIdError, useWeb3React } from '@web3-react/core'\r\nimport usePrevious from '../../hooks/usePrevious'\r\nimport { useWalletModalOpen, useWalletModalToggle } from '../../state/application/hooks'\r\n\r\nimport Modal from '../Modal'\r\nimport AccountDetails from '../AccountDetails'\r\nimport PendingView from './PendingView'\r\nimport Option from './Option'\r\nimport { SUPPORTED_WALLETS } from '../../constants'\r\nimport { ExternalLink } from '../../theme'\r\nimport MetamaskIcon from '../../assets/images/metamask.png'\r\nimport { ReactComponent as Close } from '../../assets/images/x.svg'\r\nimport { injected, fortmatic, portis } from '../../connectors'\r\nimport { OVERLAY_READY } from '../../connectors/Fortmatic'\r\nimport { WalletConnectConnector } from '@web3-react/walletconnect-connector'\r\nimport { AbstractConnector } from '@web3-react/abstract-connector'\r\n\r\nconst CloseIcon = styled.div`\r\n  position: absolute;\r\n  right: 1rem;\r\n  top: 14px;\r\n  &:hover {\r\n    cursor: pointer;\r\n    opacity: 0.6;\r\n  }\r\n`\r\n\r\nconst CloseColor = styled(Close)`\r\n  path {\r\n    stroke: ${({ theme }) => theme.text4};\r\n  }\r\n`\r\n\r\nconst Wrapper = styled.div`\r\n  ${({ theme }) => theme.flexColumnNoWrap}\r\n  margin: 0;\r\n  padding: 0;\r\n  width: 100%;\r\n`\r\n\r\nconst HeaderRow = styled.div`\r\n  ${({ theme }) => theme.flexRowNoWrap};\r\n  padding: 1rem 1rem;\r\n  font-weight: 500;\r\n  color: ${props => (props.color === 'blue' ? ({ theme }) => theme.primary1 : 'inherit')};\r\n  ${({ theme }) => theme.mediaWidth.upToMedium`\r\n    padding: 1rem;\r\n  `};\r\n`\r\n\r\nconst ContentWrapper = styled.div`\r\n  background-color: ${({ theme }) => theme.bg2};\r\n  padding: 2rem;\r\n  border-bottom-left-radius: 20px;\r\n  border-bottom-right-radius: 20px;\r\n\r\n  ${({ theme }) => theme.mediaWidth.upToMedium`padding: 1rem`};\r\n`\r\n\r\nconst UpperSection = styled.div`\r\n  position: relative;\r\n\r\n  h5 {\r\n    margin: 0;\r\n    margin-bottom: 0.5rem;\r\n    font-size: 1rem;\r\n    font-weight: 400;\r\n  }\r\n\r\n  h5:last-child {\r\n    margin-bottom: 0px;\r\n  }\r\n\r\n  h4 {\r\n    margin-top: 0;\r\n    font-weight: 500;\r\n  }\r\n`\r\n\r\nconst Blurb = styled.div`\r\n  ${({ theme }) => theme.flexRowNoWrap}\r\n  align-items: center;\r\n  justify-content: center;\r\n  flex-wrap: wrap;\r\n  margin-top: 2rem;\r\n  ${({ theme }) => theme.mediaWidth.upToMedium`\r\n    margin: 1rem;\r\n    font-size: 12px;\r\n  `};\r\n`\r\n\r\nconst OptionGrid = styled.div`\r\n  display: grid;\r\n  grid-gap: 10px;\r\n  ${({ theme }) => theme.mediaWidth.upToMedium`\r\n    grid-template-columns: 1fr;\r\n    grid-gap: 10px;\r\n  `};\r\n`\r\n\r\nconst HoverText = styled.div`\r\n  :hover {\r\n    cursor: pointer;\r\n  }\r\n`\r\n\r\nconst WALLET_VIEWS = {\r\n  OPTIONS: 'options',\r\n  OPTIONS_SECONDARY: 'options_secondary',\r\n  ACCOUNT: 'account',\r\n  PENDING: 'pending'\r\n}\r\n\r\nexport default function WalletModal({\r\n  pendingTransactions,\r\n  confirmedTransactions,\r\n  ENSName\r\n}: {\r\n  pendingTransactions: string[] // hashes of pending\r\n  confirmedTransactions: string[] // hashes of confirmed\r\n  ENSName?: string\r\n}) {\r\n  const { active, account, connector, activate, error } = useWeb3React()\r\n\r\n  const [walletView, setWalletView] = useState(WALLET_VIEWS.ACCOUNT)\r\n\r\n  const [pendingWallet, setPendingWallet] = useState<AbstractConnector | undefined>()\r\n\r\n  const [pendingError, setPendingError] = useState<boolean>()\r\n\r\n  const walletModalOpen = useWalletModalOpen()\r\n  const toggleWalletModal = useWalletModalToggle()\r\n\r\n  const previousAccount = usePrevious(account)\r\n\r\n  // close on connection, when logged out before\r\n  useEffect(() => {\r\n    if (account && !previousAccount && walletModalOpen) {\r\n      toggleWalletModal()\r\n    }\r\n  }, [account, previousAccount, toggleWalletModal, walletModalOpen])\r\n\r\n  // always reset to account view\r\n  useEffect(() => {\r\n    if (walletModalOpen) {\r\n      setPendingError(false)\r\n      setWalletView(WALLET_VIEWS.ACCOUNT)\r\n    }\r\n  }, [walletModalOpen])\r\n\r\n  // close modal when a connection is successful\r\n  const activePrevious = usePrevious(active)\r\n  const connectorPrevious = usePrevious(connector)\r\n  useEffect(() => {\r\n    if (walletModalOpen && ((active && !activePrevious) || (connector && connector !== connectorPrevious && !error))) {\r\n      setWalletView(WALLET_VIEWS.ACCOUNT)\r\n    }\r\n  }, [setWalletView, active, error, connector, walletModalOpen, activePrevious, connectorPrevious])\r\n\r\n  const tryActivation = async (connector: AbstractConnector | undefined) => {\r\n    let name = ''\r\n    Object.keys(SUPPORTED_WALLETS).map(key => {\r\n      if (connector === SUPPORTED_WALLETS[key].connector) {\r\n        return (name = SUPPORTED_WALLETS[key].name)\r\n      }\r\n      return true\r\n    })\r\n    // log selected wallet\r\n    ReactGA.event({\r\n      category: 'Wallet',\r\n      action: 'Change Wallet',\r\n      label: name\r\n    })\r\n    setPendingWallet(connector) // set wallet for pending view\r\n    setWalletView(WALLET_VIEWS.PENDING)\r\n\r\n    // if the connector is walletconnect and the user has already tried to connect, manually reset the connector\r\n    if (connector instanceof WalletConnectConnector && connector.walletConnectProvider?.wc?.uri) {\r\n      connector.walletConnectProvider = undefined\r\n    }\r\n\r\n    connector &&\r\n      activate(connector, undefined, true).catch(error => {\r\n        if (error instanceof UnsupportedChainIdError) {\r\n          activate(connector) // a little janky...can't use setError because the connector isn't set\r\n        } else {\r\n          setPendingError(true)\r\n        }\r\n      })\r\n  }\r\n\r\n  // close wallet modal if fortmatic modal is active\r\n  useEffect(() => {\r\n    fortmatic.on(OVERLAY_READY, () => {\r\n      toggleWalletModal()\r\n    })\r\n  }, [toggleWalletModal])\r\n\r\n  // get wallets user can switch too, depending on device/browser\r\n  function getOptions() {\r\n    const isMetamask = window.ethereum && window.ethereum.isMetaMask\r\n    return Object.keys(SUPPORTED_WALLETS).map(key => {\r\n      const option = SUPPORTED_WALLETS[key]\r\n      // check for mobile options\r\n      if (isMobile) {\r\n        //disable portis on mobile for now\r\n        if (option.connector === portis) {\r\n          return null\r\n        }\r\n\r\n        if (!window.web3 && !window.ethereum && option.mobile) {\r\n          return (\r\n            <Option\r\n              onClick={() => {\r\n                option.connector !== connector && !option.href && tryActivation(option.connector)\r\n              }}\r\n              id={`connect-${key}`}\r\n              key={key}\r\n              active={option.connector && option.connector === connector}\r\n              color={option.color}\r\n              link={option.href}\r\n              header={option.name}\r\n              subheader={null}\r\n              icon={require('../../assets/images/' + option.iconName)}\r\n            />\r\n          )\r\n        }\r\n        return null\r\n      }\r\n\r\n      // overwrite injected when needed\r\n      if (option.connector === injected) {\r\n        // don't show injected if there's no injected provider\r\n        if (!(window.web3 || window.ethereum)) {\r\n          if (option.name === 'MetaMask') {\r\n            return (\r\n              <Option\r\n                id={`connect-${key}`}\r\n                key={key}\r\n                color={'#E8831D'}\r\n                header={'Install Metamask'}\r\n                subheader={null}\r\n                link={'https://metamask.io/'}\r\n                icon={MetamaskIcon}\r\n              />\r\n            )\r\n          } else {\r\n            return null //dont want to return install twice\r\n          }\r\n        }\r\n        // don't return metamask if injected provider isn't metamask\r\n        else if (option.name === 'MetaMask' && !isMetamask) {\r\n          return null\r\n        }\r\n        // likewise for generic\r\n        else if (option.name === 'Injected' && isMetamask) {\r\n          return null\r\n        }\r\n      }\r\n\r\n      // return rest of options\r\n      return (\r\n        !isMobile &&\r\n        !option.mobileOnly && (\r\n          <Option\r\n            id={`connect-${key}`}\r\n            onClick={() => {\r\n              option.connector === connector\r\n                ? setWalletView(WALLET_VIEWS.ACCOUNT)\r\n                : !option.href && tryActivation(option.connector)\r\n            }}\r\n            key={key}\r\n            active={option.connector === connector}\r\n            color={option.color}\r\n            link={option.href}\r\n            header={option.name}\r\n            subheader={null} //use option.descriptio to bring back multi-line\r\n            icon={require('../../assets/images/' + option.iconName)}\r\n          />\r\n        )\r\n      )\r\n    })\r\n  }\r\n\r\n  function getModalContent() {\r\n    if (error) {\r\n      return (\r\n        <UpperSection>\r\n          <CloseIcon onClick={toggleWalletModal}>\r\n            <CloseColor />\r\n          </CloseIcon>\r\n          <HeaderRow>{error instanceof UnsupportedChainIdError ? 'Wrong Network' : 'Error connecting'}</HeaderRow>\r\n          <ContentWrapper>\r\n            {error instanceof UnsupportedChainIdError ? (\r\n              <h5>Please connect to the appropriate Ethereum network.</h5>\r\n            ) : (\r\n              'Error connecting. Try refreshing the page.'\r\n            )}\r\n          </ContentWrapper>\r\n        </UpperSection>\r\n      )\r\n    }\r\n    if (account && walletView === WALLET_VIEWS.ACCOUNT) {\r\n      return (\r\n        <AccountDetails\r\n          toggleWalletModal={toggleWalletModal}\r\n          pendingTransactions={pendingTransactions}\r\n          confirmedTransactions={confirmedTransactions}\r\n          ENSName={ENSName}\r\n          openOptions={() => setWalletView(WALLET_VIEWS.OPTIONS)}\r\n        />\r\n      )\r\n    }\r\n    return (\r\n      <UpperSection>\r\n        <CloseIcon onClick={toggleWalletModal}>\r\n          <CloseColor />\r\n        </CloseIcon>\r\n        {walletView !== WALLET_VIEWS.ACCOUNT ? (\r\n          <HeaderRow color=\"blue\">\r\n            <HoverText\r\n              onClick={() => {\r\n                setPendingError(false)\r\n                setWalletView(WALLET_VIEWS.ACCOUNT)\r\n              }}\r\n            >\r\n              Back\r\n            </HoverText>\r\n          </HeaderRow>\r\n        ) : (\r\n          <HeaderRow>\r\n            <HoverText>Connect to a wallet</HoverText>\r\n          </HeaderRow>\r\n        )}\r\n        <ContentWrapper>\r\n          {walletView === WALLET_VIEWS.PENDING ? (\r\n            <PendingView\r\n              connector={pendingWallet}\r\n              error={pendingError}\r\n              setPendingError={setPendingError}\r\n              tryActivation={tryActivation}\r\n            />\r\n          ) : (\r\n            <OptionGrid>{getOptions()}</OptionGrid>\r\n          )}\r\n          {walletView !== WALLET_VIEWS.PENDING && (\r\n            <Blurb>\r\n              <span>New to Ethereum? &nbsp;</span>{' '}\r\n              <ExternalLink href=\"https://ethereum.org/wallets/\">Learn more about wallets</ExternalLink>\r\n            </Blurb>\r\n          )}\r\n        </ContentWrapper>\r\n      </UpperSection>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <Modal isOpen={walletModalOpen} onDismiss={toggleWalletModal} minHeight={false} maxHeight={90}>\r\n      <Wrapper>{getModalContent()}</Wrapper>\r\n    </Modal>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}